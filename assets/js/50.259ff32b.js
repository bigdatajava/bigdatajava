(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{417:function(s,n,a){"use strict";a.r(n);var e=a(5),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"mongodb基本概念详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb基本概念详解"}},[s._v("#")]),s._v(" MongoDB基本概念详解")]),s._v(" "),n("p",[n("strong",[s._v("Mongo")]),s._v(" 是 hu"),n("strong",[s._v("mongo")]),s._v("us 的中间部分，在英文里是“巨大无比”的意思。所以 MongoDB 可以翻译成“巨大无比的数据库”，更优雅的叫法是“海量数据库”。"),n("strong",[s._v("Mongodb")]),s._v("是一款"),n("strong",[s._v("非关系型")]),s._v("数据库，说到非关系型数据库，区别于关系型数据库最显著的特征就是没有SQL语句，数据没有固定的数据类型，关系数据库的所使用的SQL语句自从 IBM 发明出来以后，已经有 40 多年的历史了，但是时至今日，开发程序员一般不太喜欢这个东西，因为它的基本理念和程序员编程的想法不一致。后来所谓的 NoSQL 风，指的就是那些不用 SQL 作为查询语言的数据存储系统，而文档数据库 MongoDB 正是 NoSQL 的代表。")]),s._v(" "),n("p",[s._v("看一下当下 数据库的排名就会发现，目前排在Mongodb数据库前面的无一例外是老牌的关系型数据库，而在No SQL序列中，Mongodb排名第一，且有上升的趋势")]),s._v(" "),n("p",[s._v("以下来自 https://www.db-engines.com 的数据")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/1.png",alt:""}})]),s._v(" "),n("p",[s._v("我们在正式进入Mongodb的学习之前，先来了解一下，MongoDB都有哪些特点，为什么要引入MongoDB以及MongoDB和关系型数据库的差异？")]),s._v(" "),n("ol",[n("li",[s._v("MongoDB中的记录是一个文档，它是由字段和值对组成的数据结构。MongoDB文档类似于JSON对象。字段的值可以包括其他文档，数组和文档数组。MongoDB数据模型和你的对象在内存中的表现形式一样，一目了然的对象模型。")])]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/2.png",alt:""}})]),s._v(" "),n("p",[s._v("关系型数据库设计（第三范式）：")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/3.png",alt:""}})]),s._v(" "),n("p",[s._v("2.同一个集合中可以包含不同字段（类型）的文档对象：同一个集合的字段可能不同")]),s._v(" "),n("p",[s._v("3.线上修改数据模式，修改时应用与数据库都无须下线")]),s._v(" "),n("p",[s._v("关系型数据库和文档型数据库主要概念对应")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th"),s._v(" "),n("th",[n("strong",[s._v("关系型数据库")])]),s._v(" "),n("th",[n("strong",[s._v("文档型数据库")])])])]),s._v(" "),n("tbody",[n("tr",[n("td",[n("strong",[s._v("模型实体")])]),s._v(" "),n("td",[s._v("表")]),s._v(" "),n("td",[s._v("集合")])]),s._v(" "),n("tr",[n("td",[n("strong",[s._v("模型属性")])]),s._v(" "),n("td",[s._v("列")]),s._v(" "),n("td",[s._v("字段")])]),s._v(" "),n("tr",[n("td",[n("strong",[s._v("模型关系")])]),s._v(" "),n("td",[s._v("表关联")]),s._v(" "),n("td",[s._v("内嵌数组，引用字段关联")])])])]),s._v(" "),n("h2",{attrs:{id:"mongodb安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb安装"}},[s._v("#")]),s._v(" MongoDB安装")]),s._v(" "),n("ol",[n("li",[s._v("获取安装包")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.4.2.tgz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("进行解压")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("tar -xvzf  mongodb-linux-x86_64-rhel70-4.4.2.tgz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[s._v("添加到系统执行路径下面( ~/.bashrc)")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("export PATH=$PATH:<你机器MongoDB bin目录，如：/usr/local/mongodb/mongodb-linux-x86_64-rhel70-4.4.2/bin>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("执行 source ~/.bashrc")]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[s._v("创建数据目录")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mkdir -p /data/db # 这个路径是MongoDB默认的数据存放路径\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"5"}},[n("li",[s._v("启动MongoDB服务")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongod  # 如果你不希望使用的默认数据目录可以通过  添加 --dbpath 参数指定路径\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("或者从后台启动")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongod  --logpath /data/db/logpath/output  --fork  \n需要指定 --logpath , 或者--syslog  \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("出现如下图所示提示则说明服务已经启动成功")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/4.png",alt:""}})]),s._v(" "),n("p",[s._v("https://docs.mongodb.com/guides/server/install/")]),s._v(" "),n("p",[n("strong",[s._v("客户端使用( mongo shell, 用来操作MongoDB的javascript客户端界面 )：")])]),s._v(" "),n("ol",[n("li",[s._v("连接服务")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongo --host <HOSTNAME> --port <PORT>  \n# 如果在本机使用的都是默认参数，也可以直接忽略所有参数\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("设置密码")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('use admin  # 设置密码需要切换到admin库\n\ndb.createUser(\n  {\n    user: "gj",\n    pwd: "gj123",\n    roles: [ "root" ]\n  }\n)\nshow users # 查看所有用户信息            \n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/5.png",alt:""}})]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("停服务")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.shutdownServer()  # 停掉服务\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[n("p",[s._v("exit  退出 mongo")])]),s._v(" "),n("li",[n("p",[s._v("以授权模式启动")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongod  --auth\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"6"}},[n("li",[s._v("授权方式连接")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongo -u gj\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",{attrs:{start:"7"}},[n("li",[s._v("连上之后就可以进行操作：")])]),s._v(" "),n("p",[s._v("连上之后先来看看都有哪些操作")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/6.png",alt:""}})]),s._v(" "),n("p",[s._v("连接进来之后，就是一个命令行的窗体， 这也是JavaScript 语言的运行环境，所以可以在上面用javascript 进行脚本编写，执行，操作，管理数据库。")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/7.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("安全说明：")])]),s._v(" "),n("p",[s._v("MongoDB基于安全性考虑，默认安装后只会绑定本地回环 IP 127.0.0.1, 可以通过启动服务时，指定绑定的IP  如 只允许通过 IP:  192.168.109.200 访问，")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongod --bind_ip 192.168.109.200 \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("这时登录需要通过")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mongo -host 192.168.109.200 -u  gj \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("通过命令访问 MongoDB")]),s._v(" "),n("p",[s._v("https://docs.mongodb.com/manual/tutorial/getting-started/")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("输入  db # 显示当前所在的数据库\nuse  example # 切换数据库\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("UI客户端访问：")])]),s._v(" "),n("p",[s._v("https://docs.mongodb.com/compass/master/install")]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/8.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("基本操作：添加数据")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.集合.insertOne(<JSON对象>)   // 添加单个文档\ndb.集合.insertMany([{<JSON对象1>},{<JSON对象2>}])   // 批量添加文档\ndb.集合.insert()   // 添加单个文档\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("开始创建文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.insertOne(\ndoc ,\n{\n  writeConcern: 安全级别   // 可选字段\n}\n)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("writeConcern 定义了本次文档创建操作的安全写级别简单来说， 安全写级别用来判断一次数据库写入操作是否成功，安全写级别越高，丢失数据的风险就越低，然而写入操作的延迟也可能更高。")]),s._v(" "),n("p",[s._v("writeConcern 决定一个写操作落到多少个节点上才算成功。 writeConcern的取值包括")]),s._v(" "),n("p",[s._v("0： 发起写操作，不关心是否成功")]),s._v(" "),n("p",[s._v("1- 集群中最大数据节点数： 写操作需要被复制到指定节点数才算成功")]),s._v(" "),n("p",[s._v("majority: 写操作需要被复制到大多数节点上才算成功")]),s._v(" "),n("p",[s._v("发起写操作的程序将阻塞到写操作到达指定的节点数为止")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.emp.insertOne(\n{\n name:"zhangsan",\n age:20,\n sex:"m"}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/9.png",alt:""}})]),s._v(" "),n("p",[s._v("插入文档时，如果没有显示指定主键，MongoDB将默认创建一个主键，字段固定为_id,ObjectId() 可以快速生成的12字节id 作为主键，"),n("strong",[s._v("ObjectId")]),s._v(' 前四个字节代表了主键生成的时间，精确到秒。主键ID在客户端驱动生成，一定程度上代表了顺序性，但不保证顺序性， 可以通过ObjectId("id值").getTimestamp() 获取创建时间。')]),s._v(" "),n("p",[s._v("如：")]),s._v(" "),n("p",[s._v('ObjectId("5fe0ef13ac05741b758b3ced").getTimestamp();')]),s._v(" "),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/10.png",alt:""}})]),s._v(" "),n("p",[s._v("创建多个文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.insertMany(\n[   {doc } , {doc }, ....],\n  {\n   writeConcern: doc, \n   ordered: true/false\n  }\n)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("ordered:  觉得是否按顺序进行写入")]),s._v(" "),n("p",[s._v("顺序写入时，一旦遇到错误，便会退出，剩余的文档无论正确与否，都不会写入")]),s._v(" "),n("p",[s._v("乱序写入，则只要文档可以正确写入就会正确写入，不管前面的文档是否是错误的文档")]),s._v(" "),n("p",[s._v("MongoDB以集合（collection）的形式组织数据，collection 相当于关系型数据库中的表，如果collection不存在，当你对不存在的collection进行操作时，将会自动创建一个collection")]),s._v(" "),n("p",[s._v("如下：")]),s._v(" "),n("p",[s._v("将会创建一个 inventory 集合，并且插入 5 个文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.inventory.insertMany([\n   { item: "journal", qty: 25, status: "A", size: { h: 14, w: 21, uom: "cm" }, tags: [ "blank", "red" ] },\n   { item: "notebook", qty: 50, status: "A", size: { h: 8.5, w: 11, uom: "in" }, tags: [ "red", "blank" ] },\n   { item: "paper", qty: 10, status: "D", size: { h: 8.5, w: 11, uom: "in" }, tags: [ "red", "blank", "plain" ] },\n   { item: "planner", qty: 0, status: "D", size: { h: 22.85, w: 30, uom: "cm" }, tags: [ "blank", "red" ] },\n   { item: "postcard", qty: 45, status: "A", size: { h: 10, w: 15.25, uom: "cm" }, tags: [ "blue" ] }\n]);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("上述操作返回一个包含确认指示符的文档和一个包含每个成功插入文档的_id的数组")]),s._v(" "),n("p",[n("strong",[s._v("整个文档查询：")])]),s._v(" "),n("p",[s._v("db.inventory.find({})                  查询所有的文档")]),s._v(" "),n("p",[s._v("db.inventory.find({}).pretty()      返回格式化后的文档")]),s._v(" "),n("p",[n("strong",[s._v("条件查询：")])]),s._v(" "),n("ol",[n("li",[s._v("精准等值查询")])]),s._v(" "),n("p",[n("strong",[s._v('db.inventory.find( { status: "D" } );')])]),s._v(" "),n("p",[n("strong",[s._v("db.inventory.find( { qty: 0 } );")])]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("多条件查询")])]),s._v(" "),n("p",[n("strong",[s._v('db.inventory.find( { qty: 0, status: "D" } );')])]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("嵌套对象精准查询")])]),s._v(" "),n("p",[n("strong",[s._v('db.inventory.find( { "size.uom": "in" } );')])]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[s._v("返回指定字段")])]),s._v(" "),n("p",[n("strong",[s._v("db.inventory.find( { },")]),s._v(" "),n("strong",[s._v("{ item: 1, status: 1 }")]),s._v(" "),n("strong",[s._v(");")])]),s._v(" "),n("p",[s._v("默认会返回_id 字段， 同样可以通过指定  _id:0 ,不返回_id 字段")]),s._v(" "),n("ol",{attrs:{start:"5"}},[n("li",[s._v("条件查询 and")])]),s._v(" "),n("p",[n("strong",[s._v('db.inventory.find({$and:[{"qty":0},{"status":"A"}]}).pretty();')])]),s._v(" "),n("ol",{attrs:{start:"6"}},[n("li",[s._v("条件查询 or")])]),s._v(" "),n("p",[n("strong",[s._v('db.inventory.find({$or:[{"qty":0},{"status":"A"}]}).pretty();')])]),s._v(" "),n("p",[s._v("Mongo查询条件和SQL查询对照表")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("SQL")]),s._v(" "),n("th",[s._v("MQL")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("a<>1   或者 a!=1")]),s._v(" "),n("td",[s._v("{ a : {$ne: 1}}")])]),s._v(" "),n("tr",[n("td",[s._v("a>1")]),s._v(" "),n("td",[s._v("{ a: {$gt:1}}")])]),s._v(" "),n("tr",[n("td",[s._v("a>=1")]),s._v(" "),n("td",[s._v("{ a: {$gte:1}}")])]),s._v(" "),n("tr",[n("td",[s._v("a<1")]),s._v(" "),n("td",[s._v("{ a: {$lt:1}}")])]),s._v(" "),n("tr",[n("td",[s._v("a<=1")]),s._v(" "),n("td",[s._v("{ a: { $lte:1}}")])]),s._v(" "),n("tr",[n("td",[s._v("in")]),s._v(" "),n("td",[s._v("{ a: { $in:[ x, y, z]}}")])]),s._v(" "),n("tr",[n("td",[s._v("not in")]),s._v(" "),n("td",[s._v("{ a: { $nin:[ x, y, z]}}")])]),s._v(" "),n("tr",[n("td",[s._v("a is null")]),s._v(" "),n("td",[s._v("{ a: { $exists: false }}")])])])]),s._v(" "),n("p",[s._v("insertOne, inertMany, insert 的区别")]),s._v(" "),n("p",[s._v("insertOne, 和 insertMany命令不支持 explain命令")]),s._v(" "),n("p",[s._v("insert支持 explain命令")]),s._v(" "),n("p",[n("strong",[s._v("复合主键")])]),s._v(" "),n("p",[s._v("可以使用文档作为复合主键")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.demeDoc.insert(\n{\n  _id: {  product_name: 1,  product_type: 2},\nsupplierId:" 001",\ncreate_Time: new Date()\n}\n)\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("注意复合主键，字段顺序换了，会当做不同的对象被创建，即使内容完全一致")]),s._v(" "),n("p",[n("strong",[s._v("逻辑操作符匹配")])]),s._v(" "),n("p",[s._v("$not : 匹配筛选条件不成立的文档")]),s._v(" "),n("p",[s._v("$and : 匹配多个筛选条件同时满足的文档")]),s._v(" "),n("p",[s._v("$or : 匹配至少一个筛选条件成立的文档")]),s._v(" "),n("p",[s._v("$nor :  匹配多个筛选条件全部不满足的文档")]),s._v(" "),n("p",[s._v("构造一组数据:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.insertMany([\n{\n  nickName:"曹操",\n  points:1000\n},\n{\n  nickName:"刘备",\n  points:500\n\n}\n]);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$not \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("用法:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{ field： { $not : {  operator-expression} }}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("积分不小于100 的")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find({points: { $not: { $lt: 100}}}  );\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("$not 也会筛选出并不包含查询字段的文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$and\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("用法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{ $and :  [ condition expression1 , condition expression2 .....   ]}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("昵称等于曹操， 积分大于 1000 的文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.find({$and : [ {nickName:{ $eq : "曹操"}}, {points:{ $gt:1000}}]});\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("当作用在不同的字段上时 可以省略 $and")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.find({nickName:{ $eq : "曹操"}, points:{ $gt:1000}});\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("当作用在同一个字段上面时可以简化为")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find({points:{ $gte:1000, $lte:2000}});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$or \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("用法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{ $or :{ condition1, condition2, condition3,... }}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.find(\n{$or : [ \n      {nickName:{ $eq : "刘备"}}, \n      {points:{ $gt:1000}}]}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("如果都是等值查询的话， $or  和 $in 结果是一样的")]),s._v(" "),n("p",[n("strong",[s._v("字段匹配")])]),s._v(" "),n("p",[s._v("$exists：匹配包含查询字段的文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{ field : {$exists:  <boolean>} }\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("文档游标")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cursor.count( applySkipLimit)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/11.png",alt:""}})]),s._v(" "),n("p",[s._v("默认情况下 ， 这里的count不会考虑 skip 和 limit的效果，如果希望考虑 limit 和 skip ，需要设置为 true。 分布式环境下，count 不保证数据的绝对正确")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cursor.sort( <doc>)       \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[s._v("这里的 定义了排序的要求")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("{ field: ordering}         \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[s._v("1 表示由小到大， -1 表示逆向排序")]),s._v(" "),n("p",[s._v("当同时应用  sort， skip， limit 时 ，应用的顺序为   sort， skip， limit")]),s._v(" "),n("p",[s._v("文档投影： 可以有选择性的返回数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.find(  查询条件,  投影设置)              \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("投影设置：{ field:   < 1 ：1 表示需要返回， 0： 表示不需要返回 ， 只能为 0，或者1 ， 非主键字段，不能同时混选0 或 1>}")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find({},{_id:0 ,nickName:1, points:1})           \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find({},{_id:0 ,nickName:1, points:0})              \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("​    "),n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mongodb/12.png",alt:""}})]),s._v(" "),n("p",[s._v("可以使用 $slice 返回数组中的部分元素")]),s._v(" "),n("p",[s._v("如， 先添加一个数组元素的文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.insertOne(\n{\n _id: {uid:3,accountType: "qq"},\n nickName:"张飞",\n points:1200,\n address:[\n {address:"xxx",post_no:0000},\n {address:"yyyyy",post_no:0002}\n ]}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("返回数组的第一个元素")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find(\n{},\n{_id:0, \n nickName:1,\n points:1,\n address: \n    {$slice:1}\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("返回倒数第一个")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.members.find(\n{},\n{_id:0, \n nickName:1,\n points:1,\n address:{$slice:-1}}\n );\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("slice: 值")]),s._v(" "),n("p",[s._v("1： 数组第一个元素")]),s._v(" "),n("p",[s._v("-1：最后一个元素")]),s._v(" "),n("p",[s._v("-2：最后两个元素")]),s._v(" "),n("p",[s._v("slice[ 1,2 ] : skip, limit  对应的关系")]),s._v(" "),n("p",[s._v("还可以使用 elementMatch 进行数组元素进行匹配")]),s._v(" "),n("p",[s._v("添加一组数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.insertOne(\n{\n _id: {uid:4,accountType: "qq"},\n nickName:"张三",\n points:1200,\n tag:["student","00","IT"]}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v('查询tag数组中第一个匹配"00" 的元素')]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.members.find(\n  {},\n  {_id:0,\n   nickName:1,\n   points:1,\n   tag: {  $elemMatch:  {$eq:  "00" } }\n});\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("更新操作")])]),s._v(" "),n("p",[s._v("updateOne/updateMany 方法要求更新条件部分必须具有以下之一，否则将报错")]),s._v(" "),n("p",[s._v("$set   给符合条件的文档新增一个字段，有该字段则修改其值")]),s._v(" "),n("p",[s._v("$unset  给符合条件的文档，删除一个字段")]),s._v(" "),n("p",[s._v("$push： 增加一个对象到数组底部")]),s._v(" "),n("p",[s._v("$pop：从数组底部删除一个对象")]),s._v(" "),n("p",[s._v("$pull：如果匹配指定的值，从数组中删除相应的对象")]),s._v(" "),n("p",[s._v("$pullAll：如果匹配任意的值，从数据中删除相应的对象")]),s._v(" "),n("p",[s._v("$addToSet：如果不存在则增加一个值到数组")]),s._v(" "),n("p",[n("strong",[s._v("更新文档：")])]),s._v(" "),n("p",[s._v("单条插入数据， 插入两跳")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.userInfo.insert([\n{ name:"zhansan",\n  tag:["90","Programmer","PhotoGrapher"]\n},\n{  name:"lisi",\n   tag:["90","Accountant","PhotoGrapher"] \n}]);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("将tag 中有90 的文档，增加一个字段： flag: 1")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.userInfo.updateMany(\n{tag:"90"},\n{$set:{flag:1}}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("只修改一个则用")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.userInfo.updateOne(\n {tag:"90"},\n {$set:{flag:2}}\n );\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("基于上面这两条数据，可以来查询一下数组中的元素")])]),s._v(" "),n("p",[s._v("userInfo 中，会计和程序员的文档")]),s._v(" "),n("p",[s._v("db.userInfo.find(")]),s._v(" "),n("p",[s._v("{$or:")]),s._v(" "),n("p",[s._v("[")]),s._v(" "),n("p",[s._v('​    {tag:"Accountant"},')]),s._v(" "),n("p",[s._v('​    {tag:"Programmer"}')]),s._v(" "),n("p",[s._v("]")]),s._v(" "),n("p",[s._v("});")]),s._v(" "),n("p",[s._v("userInfo 中，90后的文档")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.userInfo.find({tag:"90"});\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("更新文档")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.update( <query>,<update>,<options>)              \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("query",[s._v("定义了更新时的筛选条件")])],1),s._v(" "),n("p",[n("update",[s._v("文档提供了更新内容")])],1),s._v(" "),n("p",[n("options",[s._v("声明了一些更新操作的参数")])],1),s._v(" "),n("p",[s._v("更新文档操作只会作用在第一个匹配的文档上")]),s._v(" "),n("p",[s._v("如果 不包含任何更新操作符，则会直接使用update 文档替换集合中符合文档筛选条件的文档")]),s._v(" "),n("p",[n("strong",[s._v("更新特定字段")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.update(<query>,<update>,<options>)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("query",[s._v(" 定义了更新时的筛选条件")])],1),s._v(" "),n("p",[n("update",[s._v(" 文档提供了更新内容")])],1),s._v(" "),n("p",[n("options",[s._v(" 声明了一些更新操作的参数")])],1),s._v(" "),n("p",[s._v("如果只包含更新操作符，db.collection.update() 将会使用update更新集合中符合筛选条件的文档中的特定字段。")]),s._v(" "),n("p",[s._v("默认只会更新第一个匹配的值，可以通过设置  options {multi: true} 设置匹配多个文档并更新")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.doc.update(\n  {name:"zhangsan"},\n  {$set:{ flag: 1 }},\n  {multi:true}\n);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("更新操作符")])]),s._v(" "),n("p",[s._v("$set 更新或新增字段")]),s._v(" "),n("p",[s._v("$unset删除字段")]),s._v(" "),n("p",[s._v("$rename 重命名字段")]),s._v(" "),n("p",[s._v("$inc 加减字段值")]),s._v(" "),n("p",[s._v("$mul 相乘字段值")]),s._v(" "),n("p",[s._v("$min  采用最小值")]),s._v(" "),n("p",[s._v("$max  次用最大值")]),s._v(" "),n("p",[n("strong",[s._v("删除文档")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.remove(<query>,<options>)              \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("默认情况下，会删除所有满足条件的文档， 可以设定参数 { justOne:true},只会删除满足添加的第一条文档")]),s._v(" "),n("p",[n("strong",[s._v("删除集合")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.collection.drop( { writeConcern:<doc>})            \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("doc定义了本次删除集合操作的安全写级别")]),s._v(" "),n("p",[s._v("这个指令不但删除集合内的所有文档，且删除集合的索引")]),s._v(" "),n("p",[s._v("db.collection.remove 只会删除所有的文档，直接使用remve删除所有文档效率比较低，可以使用 drop 删除集合，才重新创建集合以及索引。")]),s._v(" "),n("p",[n("strong",[s._v("查询数组中的对象")])]),s._v(" "),n("p",[s._v("加两行数据，文档中存在数组，且数组中你的元素为对象")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('db.userInfo.insertMany([\n{  name:"wangwu",\n   tag: ["90","accountant","PhotoGrapher"],\n  address:[{province:"hunan",city:"changsha"},{province:"hubei",city:"wuhan"}]},\n{  name:"zhaoliu",\n   tag: ["90","accountant","PhotoGrapher"],\n  address:[{province:"hunan",city:"changsha"},{province:"hubei",city:"huanggang"}]}\n]);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[n("strong",[s._v("删除文档 remove")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db.userInfo.remove({   条件查询});        \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);