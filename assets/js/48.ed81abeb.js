(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{391:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("ğŸ€  â›„ï¸  ğŸ€")]),s._v(" "),a("h2",{attrs:{id:"rdbå¿«ç…§-snapshot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rdbå¿«ç…§-snapshot"}},[s._v("#")]),s._v(" RDBå¿«ç…§ï¼ˆsnapshotï¼‰")]),s._v(" "),a("h3",{attrs:{id:"saveæ–¹å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#saveæ–¹å¼"}},[s._v("#")]),s._v(" saveæ–¹å¼")]),s._v(" "),a("p",[s._v("åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ Redis å°†å†…å­˜æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚\nä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œ N ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚\næ¯”å¦‚è¯´ï¼Œ ä»¥ä¸‹è®¾ç½®ä¼šè®© Redis åœ¨æ»¡è¶³â€œ 60 ç§’å†…æœ‰è‡³å°‘æœ‰ 1000 ä¸ªé”®è¢«æ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("save 60 1000    //**å…³é—­RDBåªéœ€è¦å°†æ‰€æœ‰çš„saveä¿å­˜ç­–ç•¥æ³¨é‡Šæ‰å³å¯\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("è¿˜å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ç”ŸæˆRDBå¿«ç…§ï¼Œè¿›å…¥rediså®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤"),a("strong",[s._v("save")]),s._v("æˆ–"),a("strong",[s._v("bgsave")]),s._v("å¯ä»¥ç”Ÿæˆdump.rdbæ–‡ä»¶ï¼Œæ¯æ¬¡å‘½ä»¤æ‰§è¡Œéƒ½ä¼šå°†æ‰€æœ‰rediså†…å­˜å¿«ç…§åˆ°ä¸€ä¸ªæ–°çš„rdbæ–‡ä»¶é‡Œï¼Œå¹¶è¦†ç›–åŸæœ‰rdbå¿«ç…§æ–‡ä»¶ã€‚")]),s._v(" "),a("h3",{attrs:{id:"bgsave"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bgsave"}},[s._v("#")]),s._v(" bgsave")]),s._v(" "),a("p",[s._v("bgsaveçš„å†™æ—¶å¤åˆ¶(COW)æœºåˆ¶")]),s._v(" "),a("p",[s._v("Redis å€ŸåŠ©æ“ä½œç³»ç»Ÿæä¾›çš„å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆCopy-On-Write, COWï¼‰ï¼Œåœ¨ç”Ÿæˆå¿«ç…§çš„åŒæ—¶ï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸å¤„ç†å†™å‘½ä»¤ã€‚ç®€å•æ¥è¯´ï¼Œbgsave å­è¿›ç¨‹æ˜¯ç”±ä¸»çº¿ç¨‹ fork ç”Ÿæˆçš„ï¼Œå¯ä»¥å…±äº«ä¸»çº¿ç¨‹çš„æ‰€æœ‰å†…å­˜æ•°æ®ã€‚bgsave å­è¿›ç¨‹è¿è¡Œåï¼Œå¼€å§‹è¯»å–ä¸»çº¿ç¨‹çš„å†…å­˜æ•°æ®ï¼Œå¹¶æŠŠå®ƒä»¬å†™å…¥ RDB æ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹å¯¹è¿™äº›æ•°æ®ä¹Ÿéƒ½æ˜¯è¯»æ“ä½œï¼Œé‚£ä¹ˆï¼Œä¸»çº¿ç¨‹å’Œ bgsave å­è¿›ç¨‹ç›¸äº’ä¸å½±å“ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸»çº¿ç¨‹è¦ä¿®æ”¹ä¸€å—æ•°æ®ï¼Œé‚£ä¹ˆï¼Œè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ã€‚ç„¶åï¼Œbgsave å­è¿›ç¨‹ä¼šæŠŠè¿™ä¸ªå‰¯æœ¬æ•°æ®å†™å…¥ RDB æ–‡ä»¶ï¼Œè€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»çº¿ç¨‹ä»ç„¶å¯ä»¥ç›´æ¥ä¿®æ”¹åŸæ¥çš„æ•°æ®ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("saveä¸bgsaveå¯¹æ¯”ï¼š")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("å‘½ä»¤")])]),s._v(" "),a("th",[a("strong",[s._v("save")])]),s._v(" "),a("th",[a("strong",[s._v("bgsave")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("IOç±»å‹")]),s._v(" "),a("td",[s._v("åŒæ­¥")]),s._v(" "),a("td",[s._v("å¼‚æ­¥")])]),s._v(" "),a("tr",[a("td",[s._v("æ˜¯å¦é˜»å¡rediså…¶å®ƒå‘½ä»¤")]),s._v(" "),a("td",[s._v("æ˜¯")]),s._v(" "),a("td",[s._v("å¦(åœ¨ç”Ÿæˆå­è¿›ç¨‹æ‰§è¡Œè°ƒç”¨forkå‡½æ•°æ—¶ä¼šæœ‰çŸ­æš‚é˜»å¡)")])]),s._v(" "),a("tr",[a("td",[s._v("å¤æ‚åº¦")]),s._v(" "),a("td",[s._v("O(n)")]),s._v(" "),a("td",[s._v("O(n)")])]),s._v(" "),a("tr",[a("td",[s._v("ä¼˜ç‚¹")]),s._v(" "),a("td",[s._v("ä¸ä¼šæ¶ˆè€—é¢å¤–å†…å­˜")]),s._v(" "),a("td",[s._v("ä¸é˜»å¡å®¢æˆ·ç«¯å‘½ä»¤")])]),s._v(" "),a("tr",[a("td",[s._v("ç¼ºç‚¹")]),s._v(" "),a("td",[s._v("é˜»å¡å®¢æˆ·ç«¯å‘½ä»¤")]),s._v(" "),a("td",[s._v("éœ€è¦forkå­è¿›ç¨‹ï¼Œæ¶ˆè€—å†…å­˜")])])])]),s._v(" "),a("blockquote",[a("p",[s._v("é…ç½®è‡ªåŠ¨ç”Ÿæˆrdbæ–‡ä»¶åå°ä½¿ç”¨çš„æ˜¯bgsaveæ–¹å¼")])]),s._v(" "),a("h2",{attrs:{id:"aof-append-only-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aof-append-only-file"}},[s._v("#")]),s._v(" AOFï¼ˆappend-only fileï¼‰")]),s._v(" "),a("p",[s._v("å¿«ç…§åŠŸèƒ½å¹¶ä¸æ˜¯éå¸¸è€ä¹…ï¼ˆdurableï¼‰ï¼š å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œ Redis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼š AOF æŒä¹…åŒ–ï¼Œå°†"),a("strong",[s._v("ä¿®æ”¹çš„")]),s._v("æ¯ä¸€æ¡æŒ‡ä»¤è®°å½•è¿›æ–‡ä»¶appendonly.aofä¸­(å…ˆå†™å…¥os cacheï¼Œæ¯éš”ä¸€æ®µæ—¶é—´fsyncåˆ°ç£ç›˜)")]),s._v(" "),a("p",[s._v("æ¯”å¦‚æ‰§è¡Œå‘½ä»¤**â€œset zhuge 666â€**ï¼Œaofæ–‡ä»¶é‡Œä¼šè®°å½•å¦‚ä¸‹æ•°æ®")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("*3\n$3\nset\n$5\nzhuge\n$3\n666\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("è¿™æ˜¯ä¸€ç§respåè®®æ ¼å¼æ•°æ®ï¼Œæ˜Ÿå·åé¢çš„æ•°å­—ä»£è¡¨å‘½ä»¤æœ‰å¤šå°‘ä¸ªå‚æ•°ï¼Œ$å·åé¢çš„æ•°å­—ä»£è¡¨è¿™ä¸ªå‚æ•°æœ‰å‡ ä¸ªå­—ç¬¦")]),s._v(" "),a("p",[s._v("æ³¨æ„ï¼Œå¦‚æœæ‰§è¡Œå¸¦è¿‡æœŸæ—¶é—´çš„setå‘½ä»¤ï¼Œaofæ–‡ä»¶é‡Œè®°å½•çš„æ˜¯å¹¶ä¸æ˜¯æ‰§è¡Œçš„åŸå§‹å‘½ä»¤ï¼Œè€Œæ˜¯è®°å½•keyè¿‡æœŸçš„"),a("strong",[s._v("æ—¶é—´æˆ³")])]),s._v(" "),a("p",[s._v("æ¯”å¦‚æ‰§è¡Œ**â€œset tuling 888 ex 1000â€**ï¼Œå¯¹åº”aofæ–‡ä»¶é‡Œè®°å½•å¦‚ä¸‹")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("*3\n$3\nset\n$6\ntuling\n$3\n888\n*3\n$9\nPEXPIREAT\n$6\ntuling\n$13\n1604249786301\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ‰“å¼€ AOF åŠŸèƒ½ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" # appendonly yes              \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ä»ç°åœ¨å¼€å§‹ï¼Œ æ¯å½“ Redis æ‰§è¡Œä¸€ä¸ªæ”¹å˜æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼ˆæ¯”å¦‚ "),a("a",{attrs:{href:"http://redisdoc.com/string/set.html#set",target:"_blank",rel:"noopener noreferrer"}},[s._v("SET"),a("OutboundLink")],1),s._v("ï¼‰ï¼Œ è¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚")]),s._v(" "),a("p",[s._v("è¿™æ ·çš„è¯ï¼Œ å½“ Redis é‡æ–°å¯åŠ¨æ—¶ï¼Œ ç¨‹åºå°±å¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤æ¥è¾¾åˆ°é‡å»ºæ•°æ®é›†çš„ç›®çš„ã€‚")]),s._v(" "),a("p",[s._v("ä½ å¯ä»¥é…ç½® Redis å¤šä¹…æ‰å°†æ•°æ® fsync åˆ°ç£ç›˜ä¸€æ¬¡ã€‚")]),s._v(" "),a("p",[s._v("æœ‰ä¸‰ä¸ªé€‰é¡¹ï¼š")]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("appendfsync alwaysï¼šæ¯æ¬¡æœ‰æ–°å‘½ä»¤è¿½åŠ åˆ° AOF æ–‡ä»¶æ—¶å°±æ‰§è¡Œä¸€æ¬¡ fsync ï¼Œéå¸¸æ…¢ï¼Œä¹Ÿéå¸¸å®‰å…¨ã€‚")]),s._v(" "),a("li",[s._v("appendfsync everysecï¼šæ¯ç§’ fsync ä¸€æ¬¡ï¼Œè¶³å¤Ÿå¿«ï¼Œå¹¶ä¸”åœ¨æ•…éšœæ—¶åªä¼šä¸¢å¤± 1 ç§’é’Ÿçš„æ•°æ®ã€‚")]),s._v(" "),a("li",[s._v("appendfsync noï¼šä»ä¸ fsync ï¼Œå°†æ•°æ®äº¤ç»™æ“ä½œç³»ç»Ÿæ¥å¤„ç†ã€‚æ›´å¿«ï¼Œä¹Ÿæ›´ä¸å®‰å…¨çš„é€‰æ‹©ã€‚")])])]),s._v(" "),a("p",[s._v("æ¨èï¼ˆå¹¶ä¸”ä¹Ÿæ˜¯é»˜è®¤ï¼‰çš„æªæ–½ä¸ºæ¯ç§’ fsync ä¸€æ¬¡ï¼Œ è¿™ç§ fsync ç­–ç•¥å¯ä»¥å…¼é¡¾é€Ÿåº¦å’Œå®‰å…¨æ€§ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("AOFé‡å†™")])]),s._v(" "),a("p",[s._v("AOFæ–‡ä»¶é‡Œå¯èƒ½æœ‰å¤ªå¤šæ²¡ç”¨æŒ‡ä»¤ï¼Œæ‰€ä»¥AOFä¼šå®šæœŸæ ¹æ®"),a("strong",[s._v("å†…å­˜çš„æœ€æ–°æ•°æ®")]),s._v("ç”Ÿæˆaofæ–‡ä»¶")]),s._v(" "),a("p",[s._v("ä¾‹å¦‚ï¼Œæ‰§è¡Œäº†å¦‚ä¸‹å‡ æ¡å‘½ä»¤ï¼š")]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("127.0.0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("6379> incr readcount ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(integer)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("127.0.0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("6379> incr readcount ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(integer)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("2 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("127.0.0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("6379> incr readcount ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(integer)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("3 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("127.0.0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("6379> incr readcount ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(integer)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("4 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("127.0.0.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("6379> incr readcount ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(integer)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("5     ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("â€‹")]),s._v(" "),a("p",[s._v("é‡å†™åAOFæ–‡ä»¶é‡Œå˜æˆ")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("*3\n$3\nSET\n$2\nreadcount\n$1\n5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("â€‹")]),s._v(" "),a("p",[s._v("å¦‚ä¸‹ä¸¤ä¸ªé…ç½®å¯ä»¥æ§åˆ¶AOFè‡ªåŠ¨é‡å†™é¢‘ç‡")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# auto-aof-rewrite-min-size 64mb //aofæ–‡ä»¶è‡³å°‘è¦è¾¾åˆ°64Mæ‰ä¼šè‡ªåŠ¨é‡å†™ï¼Œæ–‡ä»¶å¤ªå°æ¢å¤é€Ÿåº¦æœ¬æ¥å°±å¾ˆå¿«ï¼Œé‡å†™çš„æ„ä¹‰ä¸å¤§ \n# auto-aof-rewrite-percentage 100 //aofæ–‡ä»¶è‡ªä¸Šä¸€æ¬¡é‡å†™åæ–‡ä»¶å¤§å°å¢é•¿äº†100%åˆ™å†æ¬¡è§¦å‘é‡å†™    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("å½“ç„¶AOFè¿˜å¯ä»¥æ‰‹åŠ¨é‡å†™ï¼Œè¿›å…¥rediså®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤"),a("strong",[s._v("bgrewriteaof")]),s._v("é‡å†™AOF")]),s._v(" "),a("p",[s._v("æ³¨æ„ï¼Œ"),a("strong",[s._v("AOFé‡å†™redisä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹å»åš(ä¸bgsaveå‘½ä»¤ç±»ä¼¼)ï¼Œä¸ä¼šå¯¹redisæ­£å¸¸å‘½ä»¤å¤„ç†æœ‰å¤ªå¤šå½±å“")])]),s._v(" "),a("h2",{attrs:{id:"rdb-å’Œ-aof-ç”¨å“ªä¸€ä¸ª"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rdb-å’Œ-aof-ç”¨å“ªä¸€ä¸ª"}},[s._v("#")]),s._v(" RDB å’Œ AOF ï¼Œç”¨å“ªä¸€ä¸ªï¼Ÿ")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("å‘½ä»¤")])]),s._v(" "),a("th",[a("strong",[s._v("RDB")])]),s._v(" "),a("th",[a("strong",[s._v("AOF")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("å¯åŠ¨ä¼˜å…ˆçº§")]),s._v(" "),a("td",[s._v("ä½")]),s._v(" "),a("td",[s._v("é«˜")])]),s._v(" "),a("tr",[a("td",[s._v("ä½“ç§¯")]),s._v(" "),a("td",[s._v("å°")]),s._v(" "),a("td",[s._v("å¤§")])]),s._v(" "),a("tr",[a("td",[s._v("æ¢å¤é€Ÿåº¦")]),s._v(" "),a("td",[s._v("å¿«")]),s._v(" "),a("td",[s._v("æ…¢")])]),s._v(" "),a("tr",[a("td",[s._v("æ•°æ®å®‰å…¨æ€§")]),s._v(" "),a("td",[s._v("å®¹æ˜“ä¸¢æ•°æ®")]),s._v(" "),a("td",[s._v("æ ¹æ®ç­–ç•¥å†³å®š")])])])]),s._v(" "),a("p",[s._v("ç”Ÿäº§ç¯å¢ƒå¯ä»¥éƒ½å¯ç”¨ï¼Œrediså¯åŠ¨æ—¶å¦‚æœæ—¢æœ‰rdbæ–‡ä»¶åˆæœ‰aofæ–‡ä»¶åˆ™ä¼˜å…ˆé€‰æ‹©aofæ–‡ä»¶æ¢å¤æ•°æ®ï¼Œå› ä¸ºaofä¸€èˆ¬æ¥è¯´æ•°æ®æ›´å…¨ä¸€ç‚¹ã€‚")]),s._v(" "),a("h2",{attrs:{id:"redis-4-0-æ··åˆæŒä¹…åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-4-0-æ··åˆæŒä¹…åŒ–"}},[s._v("#")]),s._v(" Redis 4.0 æ··åˆæŒä¹…åŒ–")]),s._v(" "),a("p",[s._v("é‡å¯ Redis æ—¶ï¼Œæˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨ RDBæ¥æ¢å¤å†…å­˜çŠ¶æ€ï¼Œå› ä¸ºä¼šä¸¢å¤±å¤§é‡æ•°æ®ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ AOF æ—¥å¿—é‡æ”¾ï¼Œä½†æ˜¯é‡æ”¾ AOF æ—¥å¿—æ€§èƒ½ç›¸å¯¹ RDBæ¥è¯´è¦æ…¢å¾ˆå¤šï¼Œè¿™æ ·åœ¨ Redis å®ä¾‹å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯åŠ¨éœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚ Redis 4.0 ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¸¦æ¥äº†ä¸€ä¸ªæ–°çš„æŒä¹…åŒ–é€‰é¡¹â€”â€”æ··åˆæŒä¹…åŒ–ã€‚")]),s._v(" "),a("p",[s._v("é€šè¿‡å¦‚ä¸‹é…ç½®å¯ä»¥å¼€å¯æ··åˆæŒä¹…åŒ–("),a("strong",[s._v("å¿…é¡»å…ˆå¼€å¯aof")]),s._v(")ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# aof-use-rdb-preamble yes\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("å¦‚æœå¼€å¯äº†æ··åˆæŒä¹…åŒ–ï¼Œ"),a("strong",[s._v("AOFåœ¨é‡å†™æ—¶")]),s._v("ï¼Œä¸å†æ˜¯å•çº¯å°†å†…å­˜æ•°æ®è½¬æ¢ä¸ºRESPå‘½ä»¤å†™å…¥AOFæ–‡ä»¶ï¼Œè€Œæ˜¯å°†é‡å†™"),a("strong",[s._v("è¿™ä¸€åˆ»ä¹‹å‰")]),s._v("çš„å†…å­˜åšRDBå¿«ç…§å¤„ç†ï¼Œå¹¶ä¸”å°†RDBå¿«ç…§å†…å®¹å’Œ"),a("strong",[s._v("å¢é‡çš„")]),s._v("AOFä¿®æ”¹å†…å­˜æ•°æ®çš„å‘½ä»¤å­˜åœ¨ä¸€èµ·ï¼Œéƒ½å†™å…¥æ–°çš„AOFæ–‡ä»¶ï¼Œæ–°çš„æ–‡ä»¶ä¸€å¼€å§‹ä¸å«appendonly.aofï¼Œç­‰åˆ°é‡å†™å®Œæ–°çš„AOFæ–‡ä»¶æ‰ä¼šè¿›è¡Œæ”¹åï¼Œè¦†ç›–åŸæœ‰çš„AOFæ–‡ä»¶ï¼Œå®Œæˆæ–°æ—§ä¸¤ä¸ªAOFæ–‡ä»¶çš„æ›¿æ¢ã€‚")]),s._v(" "),a("p",[s._v("äºæ˜¯åœ¨ Redis é‡å¯çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåŠ è½½ RDB çš„å†…å®¹ï¼Œç„¶åå†é‡æ”¾å¢é‡ AOF æ—¥å¿—å°±å¯ä»¥å®Œå…¨æ›¿ä»£ä¹‹å‰çš„ AOF å…¨é‡æ–‡ä»¶é‡æ”¾ï¼Œå› æ­¤é‡å¯æ•ˆç‡å¤§å¹…å¾—åˆ°æå‡ã€‚")]),s._v(" "),a("p",[s._v("æ··åˆæŒä¹…åŒ–AOFæ–‡ä»¶ç»“æ„å¦‚ä¸‹")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/redis/1.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"redisæ•°æ®å¤‡ä»½ç­–ç•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redisæ•°æ®å¤‡ä»½ç­–ç•¥"}},[s._v("#")]),s._v(" Redisæ•°æ®å¤‡ä»½ç­–ç•¥")]),s._v(" "),a("ol",[a("li",[s._v("å†™crontabå®šæ—¶è°ƒåº¦è„šæœ¬ï¼Œæ¯å°æ—¶éƒ½copyä¸€ä»½rdbæˆ–aofçš„å¤‡ä»½åˆ°ä¸€ä¸ªç›®å½•ä¸­å»ï¼Œä»…ä»…ä¿ç•™æœ€è¿‘48å°æ—¶çš„å¤‡ä»½")]),s._v(" "),a("li",[s._v("æ¯å¤©éƒ½ä¿ç•™ä¸€ä»½å½“æ—¥çš„æ•°æ®å¤‡ä»½åˆ°ä¸€ä¸ªç›®å½•ä¸­å»ï¼Œå¯ä»¥ä¿ç•™æœ€è¿‘1ä¸ªæœˆçš„å¤‡ä»½")]),s._v(" "),a("li",[s._v("æ¯æ¬¡copyå¤‡ä»½çš„æ—¶å€™ï¼Œéƒ½æŠŠå¤ªæ—§çš„å¤‡ä»½ç»™åˆ äº†")]),s._v(" "),a("li",[s._v("æ¯å¤©æ™šä¸Šå°†å½“å‰æœºå™¨ä¸Šçš„å¤‡ä»½å¤åˆ¶ä¸€ä»½åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œä»¥é˜²æœºå™¨æŸå")])]),s._v(" "),a("h2",{attrs:{id:"redisæ•°æ®å¤‡ä»½æ¢å¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redisæ•°æ®å¤‡ä»½æ¢å¤"}},[s._v("#")]),s._v(" Redisæ•°æ®å¤‡ä»½æ¢å¤")]),s._v(" "),a("p",[s._v("å°†å¯¹åº”çš„xx.rdbï¼Œæˆ–xx.aofå¤‡ä»½æ–‡ä»¶ï¼Œæ”¾åˆ°redisæŒ‡å®šç›®å½•ä¸‹ï¼Œå¯åŠ¨redisæ—¶å³å¯è‡ªåŠ¨æ¢å¤å¤‡ä»½ã€‚")])])}),[],!1,null,null,null);a.default=n.exports}}]);