(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{433:function(s,a,n){"use strict";n.r(a);var t=n(5),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("本次安装以 CentOS­7为例")])]),s._v(" "),a("h2",{attrs:{id:"准备安装包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备安装包"}},[s._v("#")]),s._v(" 准备安装包")]),s._v(" "),a("p",[s._v("下载地址：")]),s._v(" "),a("p",[s._v("Erlang: https://www.erlang.org/downloads")]),s._v(" "),a("p",[s._v("RabbitMQ： https://github.com/rabbitmq/rabbitmq-server/releases")]),s._v(" "),a("p",[s._v("Rabbit官网指南：https://www.rabbitmq.com/install-rpm.html#downloads")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("erlang-18.3-1.el7.centos.x86_64.rpm \nsocat-1.7.3.2-5.el7.lux.x86_64.rpm \nrabbitmq-server-3.6.5-1.noarch.rpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("For CentOS "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(", replace "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"el7"')]),s._v(" with "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"el8"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("h2",{attrs:{id:"安装erlang"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装erlang"}},[s._v("#")]),s._v(" 安装Erlang")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rpm -ivh erlang-18.3-1.el7.centos.x86_64.rpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"安装r-a-b-b-i-tmq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装r-a-b-b-i-tmq"}},[s._v("#")]),s._v(" 安装R a b b i tMQ")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rpm -ivh socat-1.7.3.2-1.1.el7.x86_64.rpm\n或者命令：yum install socat logrotate -y\n\nrpm -ivh rabbitmq-server-3.6.5-1.noarch.rpm\n或者命令：yum install rabbitmq-server-3.6.5-1.el7.noarch.rpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("blockquote",[a("p",[s._v("如果报错：")]),s._v(" "),a("p",[s._v("[root@centos soft]# rpm -ivh rabbitmq-server-3.9.8-1.el7.noarch.rpm\nwarning: rabbitmq-server-3.9.8-1.el7.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID 6026dfca: NOKEY\nerror: Failed dependencies:\nerlang >= 23.2 is needed by rabbitmq-server-3.9.8-1.el7.noarch")]),s._v(" "),a("p",[s._v("再执行命令即可：rpm -ivh --nodeps rabbitmq-server-3.9.8-1.el7.noarch.rpm")])]),s._v(" "),a("h2",{attrs:{id:"开启管理界面及配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启管理界面及配置"}},[s._v("#")]),s._v(" 开启管理界面及配置")]),s._v(" "),a("p",[s._v("开启管理界面")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rabbitmq-plugins enable rabbitmq_management\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("修改默认配置信息")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.5/ebin/rabbit.app  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v('比如修改密码、配置等等，例如：loopback_users 中的 <<"guest">>,只保留guest')])]),s._v(" "),a("h2",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service rabbitmq-server start # 启动服务 \nservice rabbitmq-server stop # 停止服务 \nservice rabbitmq-server restart # 重启服务\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("设置配置文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /usr/share/doc/rabbitmq-server-3.6.5/ \ncp rabbitmq.config.example /etc/rabbitmq/rabbitmq.config\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果web控制台无法正常访问考虑安装是否成功以及是防火墙的原因")]),s._v(" "),a("p",[s._v("关闭防火墙")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl stop firewalld\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用腾讯云 阿里云记得开放 15672端口")]),s._v(" "),a("h2",{attrs:{id:"配置虚拟主机及用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置虚拟主机及用户"}},[s._v("#")]),s._v(" 配置虚拟主机及用户")]),s._v(" "),a("h3",{attrs:{id:"用户角色"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户角色"}},[s._v("#")]),s._v(" 用户角色")]),s._v(" "),a("p",[s._v("Ra bbitMQ在安装好后，可以访问http://ip地址:15672 ；其自带了guest/guest的用户名和密码；如果需要创建自定义用户；那么也可以登录管理界面后，如下操作：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/rabbitmq/clip_image002.jpg",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/rabbitmq/clip_image004.jpg",alt:"img"}})]),s._v(" "),a("p",[s._v("角色说明：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("超级管理员(administrator)")]),s._v(" "),a("p",[s._v("可登陆管理控制台，可查看所有的信息，并且可以对用户，策略(policy)进行操作。")])]),s._v(" "),a("li",[a("p",[s._v("监控者(monitoring)")]),s._v(" "),a("p",[s._v("可登陆管理控制台，同时可以查看rabbitmq节点的相关信息(进程数，内存使用情况，磁盘使用情况等)")])]),s._v(" "),a("li",[a("p",[s._v("策略制定者(policymaker)")]),s._v(" "),a("p",[s._v("可登陆管理控制台, 同时可以对policy进行管理。但无法查看节点的相关信息(上图红框标识的部分)。")])]),s._v(" "),a("li",[a("p",[s._v("普通管理者(management)")]),s._v(" "),a("p",[s._v("仅可登陆管理控制台，无法看到节点信息，也无法对策略进行管理。")])]),s._v(" "),a("li",[a("p",[s._v("其他")]),s._v(" "),a("p",[s._v("无法登陆管理控制台，通常就是普通的生产者和消费者。")])])]),s._v(" "),a("h3",{attrs:{id:"virtual-hosts配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#virtual-hosts配置"}},[s._v("#")]),s._v(" Virtual Hosts配置")]),s._v(" "),a("p",[s._v("像mysql拥有数据库的概念并且可以指定用户对库和表等操作的权限。")]),s._v(" "),a("p",[s._v("Ra bbitMQ也有类似的权限管理；在Ra bbitMQ中可以虚拟消息服务器Virtual")]),s._v(" "),a("p",[s._v("Host，每个Virtual Hosts相当于一个相对独立的Ra bbitMQ服务器，每个")]),s._v(" "),a("p",[s._v("VirtualHost之间是相互隔离的。exchange、queue、message不能互通。 相当于mysql的db。Virtual Name一般以/开头。")]),s._v(" "),a("ol",[a("li",[s._v("创建Virtual Hosts")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/rabbitmq/clip_image006.jpg",alt:"img"}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("设置Virtual Hosts权限")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/rabbitmq/clip_image009.gif",alt:"img"}})]),s._v(" "),a("h2",{attrs:{id:"集群搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群搭建"}},[s._v("#")]),s._v(" 集群搭建")]),s._v(" "),a("p",[s._v("一般来说，如果只是为了学习Ra bbitMQ或者验证业务工程的正确性那么在本地环境或者测试环境上使用其单实例部署就可以了，但是出于MQ中间件本身的可靠性、并发性、吞吐量和消息堆积能力等问题的考虑，在生产环境上一般都会考虑使用Ra bbitMQ的集群方案。")]),s._v(" "),a("h3",{attrs:{id:"集群方案的原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群方案的原理"}},[s._v("#")]),s._v(" 集群方案的原理")]),s._v(" "),a("p",[s._v("Ra bbitMQ这款消息队列中间件产品本身是基于Erlang编写，Erlang语言天生具备分布式特性（通过同步Erlang集群各节点的cookie来实现）。Ra bbitMQ本身不需要像ActiveMQ、Kafka那样通过ZooKeeper分别来实现HA方案和保存集群的元数据。")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:%5CUsers%5CNO%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210831223158585.png",alt:"image-20210831223158585"}})]),s._v(" "),a("p",[s._v("如下案例中使用多台云服务器进行集群搭建")]),s._v(" "),a("p",[s._v("主要参考官方文档：https://www.rabbitmq.com/clustering.html 首先确保Ra bbitMQ运行没有问题")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#1、环境准备\nhostnamectl set-hostname m1\nhostnamectl set-hostname m2\n\n#2、统一 erlang.cookie 文件中 cookie 值    将m1中的 .erlang.cookie 同步到 m2中\nscp  /var/lib/rabbitmq/.erlang.cookie  m2:/var/lib/rabbitmq/.erlang.cookie\n\n#3、Rabbitmq 集群添加节点\n    #重启 m2机器中 rabbitmq 的服务 在 m2执行\n\n[root@rabbitmq2 ~]# rabbitmqctl stop_app\n[root@rabbitmq2 ~]# rabbitmqctl join_cluster --ram rabbit@m2\n[root@rabbitmq2 ~]# rabbitmqctl start_app\n[root@rabbitmq2 ~]# rabbitmq-plugins enable rabbitmq_management\n[root@rabbitmq2 ~]# systemctl restart rabbitmq-server.service \n\n#4、查看集群信息  \nrabbitmqctl cluster_status\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h3",{attrs:{id:"负载均衡-haproxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡-haproxy"}},[s._v("#")]),s._v(" 负载均衡-HAProxy")]),s._v(" "),a("p",[s._v("HAProxy提供高可用性、负载均衡以及基于TCP和HTTP应用的代理，支持虚拟主机，它是免费、快速并且可靠的一种解决方案,包括Twitter，Reddit，StackOverflow，GitHub在内的多家知名互联网公司在使用。HAProxy实现了一种事件驱动、单一进程模型，此模型支持非常大的并发连接数。")]),s._v(" "),a("p",[a("strong",[s._v("安装HAProxy")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#1、安装   \nyum  install haproxy\n\n\n#2、配置haproxy.cfg文件   具体参照 如下 1.5.2 配置HAProxy\nvim  /etc/haproxy/haproxy.cfg\n\n#3、启动haproxy\nsystemctl start haproxy\n\n#4、查看haproxy进程状态\nsystemctl status haproxy.service\n#状态如下说明 已经启动成功 Active: active (running)\n \n#访问如下地址对mq节点进行监控\nhttp://服务器IP:1080/haproxy_stats\n\n#代码中访问mq集群地址，则变为访问haproxy地址:5672\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("strong",[s._v("配置HAProxy")])]),s._v(" "),a("p",[s._v("配置文件路径：/etc/haproxy/haproxy.cfg")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#---------------------------------------------------------------------\n# Example configuration for a possible web application.  See the\n# full configuration options online.\n#\n#   http://haproxy.1wt.eu/download/1.4/doc/configuration.txt\n#\n#---------------------------------------------------------------------\n\n#---------------------------------------------------------------------\n# Global settings\n#---------------------------------------------------------------------\nglobal\n    # to have these messages end up in /var/log/haproxy.log you will\n    # need to:\n    #\n    # 1) configure syslog to accept network log events.  This is done\n    #    by adding the '-r' option to the SYSLOGD_OPTIONS in\n    #    /etc/sysconfig/syslog\n    #\n    # 2) configure local2 events to go to the /var/log/haproxy.log\n    #   file. A line like the following can be added to\n    #   /etc/sysconfig/syslog\n    #\n    #    local2.*                       /var/log/haproxy.log\n    #\n    log         127.0.0.1 local2\n\n    chroot      /var/lib/haproxy\n    pidfile     /var/run/haproxy.pid\n    maxconn     4000\n    user        haproxy\n    group       haproxy\n    daemon\n\n    # turn on stats unix socket\n    stats socket /var/lib/haproxy/stats\n\n#---------------------------------------------------------------------\n# common defaults that all the 'listen' and 'backend' sections will\n# use if not designated in their block\n#---------------------------------------------------------------------\ndefaults\n    mode                    http\n    log                     global\n    option                  httplog\n    option                  dontlognull\n    option http-server-close\n    option forwardfor       except 127.0.0.0/8\n    option                  redispatch\n    retries                 3\n    timeout http-request    10s\n    timeout queue           1m\n    timeout connect         10s\n    timeout client          1m\n    timeout server          1m\n    timeout http-keep-alive 10s\n    timeout check           10s\n    maxconn                 3000\n\n\n#对MQ集群进行监听\nlisten rabbitmq_cluster\n\tbind 0.0.0.0:5672\n\toption tcplog\n\tmode tcp \n\toption  clitcpka\n\ttimeout connect 1s \n\ttimeout client  10s\n\ttimeout server  10s\n\tbalance roundrobin\n\tserver node1 节点1 ip地址:5672 check inter 5s rise 2 fall 3  \n   server node2 节点2 ip地址:5672 check inter 5s rise 2 fall 3\n\n#开启haproxy监控服务\t\nlisten http_front\n\tbind 0.0.0.0:1080\n\tstats refresh 30s\n\tstats uri /haproxy_stats\n\tstats auth admin:admin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br")])]),a("p",[a("strong",[s._v("haproxy.cfg配置详解")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("listen rabbitmg cluster\nbind 0.0.0.0:5672#通过5672对M1, M2进行映射\noption tcplog #记录tcp连接的状态和时间\nmode tcp#四层协议代理,即对TCP协议转发\noption clitcpka #开启TCP的Keep Alive. (长连接模式)\ntimeout connect 1s #haproxy与mq建立连接的超时时间\ntimeout client 10s#客户端与haproxy最大空闲时间。\ntimeout server 10s #服务器与haproxy最大空闲时间\nbalance roundrobin #采用轮询转发消息\n#每5秒发送一次心跳包,如连续两次有响应则代表状态良好。\n#如连续三次没有响应,则视为服务故障,该节点将被剔除。\nserver node1 192.168.132.137:5672 check inter 5s rise 2 fall 3\nserver node2192.168.132.139:5672 check inter 5s rise 2 fall 3\nlisten http front\n#监听端口\nbind 0.0.0.0:1080\n#统计页面自动刷新时间stats refresh 30s\n#统计页面url\nstats uri /haproxy?stats\n#指定HAproxy访问用户名和密码设置\nstats auth admin:admin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);