(window.webpackJsonp=window.webpackJsonp||[]).push([[255],{623:function(a,s,t){"use strict";t.r(s);var l=t(5),e=Object(l.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"环境搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境搭建"}},[a._v("#")]),a._v(" 环境搭建")]),a._v(" "),s("h3",{attrs:{id:"方式一-虚拟机镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式一-虚拟机镜像"}},[a._v("#")]),a._v(" 方式一：虚拟机镜像")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/1.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/2.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/3.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/4.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/5.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/6.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/7.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/8.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/9.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/10.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/11.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/12.png",alt:""}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/13.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/14.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/15.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/16.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/17.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/18.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/19.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/baota/20.png",alt:""}})]),a._v(" "),s("h3",{attrs:{id:"方式二-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式二-docker"}},[a._v("#")]),a._v(" 方式二：Docker")]),a._v(" "),s("blockquote",[s("p",[a._v("基于Linux环境")])]),a._v(" "),s("p",[s("strong",[a._v("Docker环境安装")])]),a._v(" "),s("ul",[s("li",[a._v("安装yum-utils：")])]),a._v(" "),s("p",[a._v("yum install -y yum-utils device-mapper-persistent-data lvm2")]),a._v(" "),s("ul",[s("li",[a._v("为yum源添加docker仓库位置：")])]),a._v(" "),s("p",[a._v("yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo")]),a._v(" "),s("ul",[s("li",[a._v("安装docker：")])]),a._v(" "),s("p",[a._v("yum install docker-ce")]),a._v(" "),s("ul",[s("li",[a._v("启动docker：")])]),a._v(" "),s("p",[a._v("systemctl start docker")]),a._v(" "),s("p",[s("strong",[a._v("MySQL安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载MySQL5.7的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull mysql:5.7")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动MySQL服务：")])]),a._v(" "),s("p",[a._v("docker run -p 3306:3306 --name mysql \\ -v /mydata/mysql/log:/var/log/mysql \\ -v /mydata/mysql/data:/var/lib/mysql \\ -v /mydata/mysql/conf:/etc/mysql \\ -e MYSQL_ROOT_PASSWORD=root  \\ -d mysql:5.7")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("参数说明")])]),a._v(" "),s("li",[s("ul",[s("li",[a._v("-p 3306:3306：将容器的3306端口映射到主机的3306端口")]),a._v(" "),s("li",[a._v("-v /mydata/mysql/conf:/etc/mysql：将配置文件夹挂在到主机")]),a._v(" "),s("li",[a._v("-v /mydata/mysql/log:/var/log/mysql：将日志文件夹挂载到主机")]),a._v(" "),s("li",[a._v("-v /mydata/mysql/data:/var/lib/mysql/：将数据文件夹挂载到主机")]),a._v(" "),s("li",[a._v("-e MYSQL_ROOT_PASSWORD=root：初始化root用户的密码")])])]),a._v(" "),s("li",[s("p",[a._v("进入运行MySQL的docker容器：")])])]),a._v(" "),s("p",[a._v("docker exec -it mysql /bin/bash")]),a._v(" "),s("ul",[s("li",[a._v("使用MySQL命令打开客户端：")])]),a._v(" "),s("p",[a._v("mysql -uroot -proot --default-character-set=utf8")]),a._v(" "),s("ul",[s("li",[a._v("创建mall数据库：")])]),a._v(" "),s("p",[a._v("create database mall character set utf8")]),a._v(" "),s("ul",[s("li",[a._v("安装上传下载插件，并将document/sql/mall.sql上传到Linux服务器上：")])]),a._v(" "),s("p",[a._v("yum -y install lrzsz")]),a._v(" "),s("ul",[s("li",[a._v("将mall.sql文件拷贝到mysql容器的/目录下：")])]),a._v(" "),s("p",[a._v("docker cp /mydata/mall.sql mysql:/")]),a._v(" "),s("ul",[s("li",[a._v("将sql文件导入到数据库：")])]),a._v(" "),s("p",[a._v("use mall; source /mall.sql;")]),a._v(" "),s("ul",[s("li",[a._v("创建一个reader:123456帐号并修改权限，使得任何ip都能访问：")])]),a._v(" "),s("p",[a._v("grant all privileges on "),s("em",[a._v(".")]),a._v(" to 'reader' @'%' identified by '123456';")]),a._v(" "),s("p",[s("strong",[a._v("Redis安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载Redis5.0的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull redis:5")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动Redis服务：")])]),a._v(" "),s("p",[a._v("docker run -p 6379:6379 --name redis \\ -v /mydata/redis/data:/data \\ -d redis:5 redis-server --appendonly yes")]),a._v(" "),s("ul",[s("li",[a._v("进入Redis容器使用redis-cli命令进行连接：")])]),a._v(" "),s("p",[a._v("docker exec -it redis redis-cli")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/1.png",alt:""}})]),a._v(" "),s("p",[s("strong",[a._v("Nginx安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载Nginx1.10的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull nginx:1.10")]),a._v(" "),s("ul",[s("li",[a._v("先运行一次容器（为了拷贝配置文件）：")])]),a._v(" "),s("p",[a._v("docker run -p 80:80 --name nginx \\ -v /mydata/nginx/html:/usr/share/nginx/html \\ -v /mydata/nginx/logs:/var/log/nginx  \\ -d nginx:1.10")]),a._v(" "),s("ul",[s("li",[a._v("将容器内的配置文件拷贝到指定目录：")])]),a._v(" "),s("p",[a._v("docker container cp nginx:/etc/nginx /mydata/nginx/")]),a._v(" "),s("ul",[s("li",[a._v("修改文件名称：")])]),a._v(" "),s("p",[a._v("mv nginx conf")]),a._v(" "),s("ul",[s("li",[a._v("终止并删除容器：")])]),a._v(" "),s("p",[a._v("docker stop nginx docker rm nginx")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动Nginx服务：")])]),a._v(" "),s("p",[a._v("docker run -p 80:80 --name nginx \\ -v /mydata/nginx/html:/usr/share/nginx/html \\ -v /mydata/nginx/logs:/var/log/nginx  \\ -v /mydata/nginx/conf:/etc/nginx \\ -d nginx:1.10")]),a._v(" "),s("p",[s("strong",[a._v("RabbitMQ安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载rabbitmq3.7.15的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull rabbitmq:3.7.15")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动RabbitMQ服务：")])]),a._v(" "),s("p",[a._v("docker run -p 5672:5672 -p 15672:15672 --name rabbitmq \\ -d rabbitmq:3.7.15")]),a._v(" "),s("ul",[s("li",[a._v("进入容器并开启管理功能：")])]),a._v(" "),s("p",[a._v("docker exec -it rabbitmq /bin/bash rabbitmq-plugins enable rabbitmq_management")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/2.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("开启防火墙：")])]),a._v(" "),s("p",[a._v("firewall-cmd --zone=public --add-port=15672/tcp --permanent firewall-cmd --reload")]),a._v(" "),s("ul",[s("li",[a._v("访问地址查看是否安装成功："),s("a",{attrs:{href:"http://192.168.3.101:15672/",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://192.168.3.101:15672"),s("OutboundLink")],1)])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/3.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("输入账号密码并登录：guest guest")]),a._v(" "),s("li",[a._v("创建帐号并设置其角色为管理员：mall mall")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/4.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("创建一个新的虚拟host为：/mall")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/5.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("点击mall用户进入用户配置页面")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/6.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("给mall用户配置该虚拟host的权限")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/7.png",alt:""}})]),a._v(" "),s("p",[s("strong",[a._v("Elasticsearch安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载Elasticsearch7.6.2的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull elasticsearch:7.6.2")]),a._v(" "),s("ul",[s("li",[a._v("修改虚拟内存区域大小，否则会因为过小而无法启动:")])]),a._v(" "),s("p",[a._v("sysctl -w vm.max_map_count=262144")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动Elasticsearch服务：")])]),a._v(" "),s("p",[a._v('docker run -p 9200:9200 -p 9300:9300 --name elasticsearch \\ -e "discovery.type=single-node" \\ -e "cluster.name=elasticsearch" \\ -v /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins \\ -v /mydata/elasticsearch/data:/usr/share/elasticsearch/data \\ -d elasticsearch:7.6.2')]),a._v(" "),s("ul",[s("li",[a._v("启动时会发现/usr/share/elasticsearch/data目录没有访问权限，只需要修改/mydata/elasticsearch/data目录的权限，再重新启动即可；")])]),a._v(" "),s("p",[a._v("chmod 777 /mydata/elasticsearch/data/")]),a._v(" "),s("ul",[s("li",[a._v("安装中文分词器IKAnalyzer，并重新启动：")])]),a._v(" "),s("p",[a._v("docker exec -it elasticsearch /bin/bash #此命令需要在容器中运行 elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip docker restart elasticsearch")]),a._v(" "),s("ul",[s("li",[a._v("开启防火墙：")])]),a._v(" "),s("p",[a._v("firewall-cmd --zone=public --add-port=9200/tcp --permanent firewall-cmd --reload")]),a._v(" "),s("ul",[s("li",[a._v("访问会返回版本信息："),s("a",{attrs:{href:"http://192.168.3.101:9200/",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://192.168.3.101:9200"),s("OutboundLink")],1)])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/8.png",alt:""}})]),a._v(" "),s("p",[s("strong",[a._v("Logstash安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载Logstash7.6.2的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull logstash:7.6.2")]),a._v(" "),s("ul",[s("li",[a._v("修改Logstash的配置文件logstash.conf中output节点下的Elasticsearch连接地址为es:9200，配置文件地址：/document/elk/logstash.conf")])]),a._v(" "),s("p",[a._v('output {  elasticsearch {    hosts => "es:9200"    index => "mall-%{type}-%{+YYYY.MM.dd}"  } }')]),a._v(" "),s("ul",[s("li",[a._v("创建/mydata/logstash目录，并将Logstash的配置文件logstash.conf拷贝到该目录；")])]),a._v(" "),s("p",[a._v("mkdir /mydata/logstash")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动Logstash服务；")])]),a._v(" "),s("p",[a._v("docker run --name logstash -p 4560:4560 -p 4561:4561 -p 4562:4562 -p 4563:4563 \\ --link elasticsearch:es \\ -v /mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf \\ -d logstash:7.6.2")]),a._v(" "),s("ul",[s("li",[a._v("进入容器内部，安装json_lines插件。")])]),a._v(" "),s("p",[a._v("logstash-plugin install logstash-codec-json_lines")]),a._v(" "),s("p",[s("strong",[a._v("Kibana安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载Kibana7.6.2的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull kibana:7.6.2")]),a._v(" "),s("ul",[s("li",[a._v("使用如下命令启动Kibana服务：")])]),a._v(" "),s("p",[a._v('docker run --name kibana -p 5601:5601 \\ --link elasticsearch:es \\ -e "elasticsearch.hosts=http://es:9200" \\ -d kibana:7.6.2')]),a._v(" "),s("ul",[s("li",[a._v("开启防火墙：")])]),a._v(" "),s("p",[a._v("firewall-cmd --zone=public --add-port=5601/tcp --permanent firewall-cmd --reload")]),a._v(" "),s("ul",[s("li",[a._v("访问地址进行测试："),s("a",{attrs:{href:"http://192.168.3.101:5601/",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://192.168.3.101:5601"),s("OutboundLink")],1)])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/9.png",alt:""}})]),a._v(" "),s("p",[s("strong",[a._v("MongoDB安装")])]),a._v(" "),s("ul",[s("li",[a._v("下载MongoDB4.2.5的docker镜像：")])]),a._v(" "),s("p",[a._v("docker pull mongo:4.2.5")]),a._v(" "),s("ul",[s("li",[a._v("使用docker命令启动：")])]),a._v(" "),s("p",[a._v("docker run -p 27017:27017 --name mongo \\ -v /mydata/mongo/db:/data/db \\ -d mongo:4.2.5")]),a._v(" "),s("p",[s("strong",[a._v("Docker全部环境安装完成")])]),a._v(" "),s("ul",[s("li",[a._v("所有下载镜像文件：")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE\nredis                 5                   071538dbbd71        2 weeks ago         98.3MB\nmongo                 4.2.5               fddee5bccba3        3 months ago        388MB\nlogstash              7.6.2               fa5b3b1e9757        4 months ago        813MB\nkibana                7.6.2               f70986bc5191        4 months ago        1.01GB\nelasticsearch         7.6.2               f29a1ee41030        4 months ago        791MB\nrabbitmq              3.7.15-management   6ffc11daa8d0        13 months ago       186MB\nmysql                 5.7                 7faa3c53e6d6        15 months ago       373MB\nregistry              2                   f32a97de94e1        17 months ago       25.8MB\nnginx                 1.10                0346349a1a64        3 years ago         182MB\njava                  8                   d23bdf5b1b1b        3 years ago         643MB\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("ul",[s("li",[a._v("所有运行在容器里面的应用：")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/10.png",alt:""}})]),a._v(" "),s("p",[s("strong",[a._v("SpringBoot应用部署")])]),a._v(" "),s("p",[a._v("构建所有Docker镜像并上传")]),a._v(" "),s("ul",[s("li",[a._v("修改项目根目录下的pom.xml中的docker.host属性：")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("<properties>\n    \t\t    <docker.host>http://192.168.3.101:2375</docker.host>\n</properties>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ul",[s("li",[a._v("如果项目根目录的pom.mxl中docker-maven-plugin的节点被注释掉了就打开注释，使项目在打包时直接构建Docker镜像；")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/11.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("直接双击根项目mall的package命令可以一次性打包所有应用的Docker镜像；")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/12.png",alt:""}})]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("REPOSITORY            TAG                 IMAGE ID            CREATED              SIZE\nmall/mall-portal      1.0-SNAPSHOT        70e0f76416a0        21 seconds ago       705MB\nmall/mall-search      1.0-SNAPSHOT        f3290bd1d0c7        41 seconds ago       725MB\nmall/mall-admin       1.0-SNAPSHOT        26557b93a106        About a minute ago   705MB\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[s("strong",[a._v("部署mall-admin")])]),a._v(" "),s("p",[a._v("docker run -p 8080:8080 --name mall-admin \\ --link mysql:db \\ --link redis:redis \\ -v /etc/localtime:/etc/localtime \\ -v /mydata/app/admin/logs:/var/logs \\ -d mall/mall-admin:1.0-SNAPSHOT")]),a._v(" "),s("p",[a._v("注意：如果想使用Logstash收集日志的话，需要将应用容器连接到Logstsh，添加如下配置即可；")]),a._v(" "),s("p",[a._v("--link logstash:logstash \\")]),a._v(" "),s("p",[s("strong",[a._v("部署mall-search")])]),a._v(" "),s("p",[a._v("docker run -p 8081:8081 --name mall-search \\ --link elasticsearch:es \\ --link mysql:db \\ -v /etc/localtime:/etc/localtime \\ -v /mydata/app/search/logs:/var/logs \\ -d mall/mall-search:1.0-SNAPSHOT")]),a._v(" "),s("p",[s("strong",[a._v("部署mall-port")])]),a._v(" "),s("p",[a._v("docker run -p 8085:8085 --name mall-portal \\ --link mysql:db \\ --link redis:redis \\ --link mongo:mongo \\ --link rabbitmq:rabbit \\ -v /etc/localtime:/etc/localtime \\ -v /mydata/app/portal/logs:/var/logs \\ -d mall/mall-portal:1.0-SNAPSHOT")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://www.macrozheng.com/#/deploy/mall_deploy_docker?id=%E5%BC%80%E5%90%AF%E9%98%B2%E7%81%AB%E5%A2%99",target:"_blank",rel:"noopener noreferrer"}},[a._v("开启防火墙"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("firewall-cmd --zone=public --add-port=8080/tcp --permanent firewall-cmd --zone=public --add-port=8081/tcp --permanent firewall-cmd --zone=public --add-port=8085/tcp --permanent firewall-cmd --reload")]),a._v(" "),s("p",[a._v("访问接口进行测试")]),a._v(" "),s("ul",[s("li",[a._v("mall-admin的api接口文档地址：http://192.168.3.101:8080/swagger-ui.html")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/13.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("mall-search的api接口文档地址：http://192.168.3.101:8081/swagger-ui.html")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/14.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("mall-portal的api接口文档地址：http://192.168.3.101:8085/swagger-ui.html")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/mall2/15.png",alt:""}})]),a._v(" "),s("h3",{attrs:{id:"方式三-手动安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式三-手动安装"}},[a._v("#")]),a._v(" 方式三：手动安装")]),a._v(" "),s("blockquote",[s("p",[a._v("基于CentOS7 服务器")])]),a._v(" "),s("p",[a._v("MySQL5.7安装")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://nylg.gitee.io/pages/09fdb1/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("Redis安装")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("单机安装：https://nylg.gitee.io/pages/532082/#%E5%AE%89%E8%A3%85\n集群安装：https://nylg.gitee.io/pages/026152/#redis%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("MongoDB安装")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://nylg.gitee.io/pages/ec8b81/#mongodb%E5%AE%89%E8%A3%85\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("Nacos安装")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://nylg.gitee.io/pages/f412a9/#nacos-server%E9%83%A8%E7%BD%B2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"项目部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目部署"}},[a._v("#")]),a._v(" 项目部署")]),a._v(" "),s("h3",{attrs:{id:"nacos配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nacos配置"}},[a._v("#")]),a._v(" Nacos配置")]),a._v(" "),s("p",[a._v("项目启动需要使用Nacos，导入项目下的document/nacos-config/nacos_config_export.zip压缩包，不需要解压，直接导入")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/image-20220413163155270.png",alt:"image-20220413163155270"}})]),a._v(" "),s("ol",[s("li",[a._v("修改nacos配置：tulingmall-db-common.yml文件，配置成自己的MySQL用户名/密码")]),a._v(" "),s("li",[a._v("项目中*.yml文件里面的配置，大部分会被nacos远程的配置替换。所以只要上传nacos配置到nacos配置中心即可。修改相应的配置也是在nacos配置中心修改")])]),a._v(" "),s("h3",{attrs:{id:"rocketmq配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq配置"}},[a._v("#")]),a._v(" RocketMQ配置")]),a._v(" "),s("p",[a._v("需要添加RocketMQ的配置,配置添加到Nacos配置文件当中: tulingmall-order-dev.yml")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("rocketmq:\n  name-server: 192.168.232.198:9876 #连接超时时间\n  producer:\n    send-message-timeout: 30000 #发送消息超时时间\n    group: order-group\n  tulingmall:\n    scheduleTopic: order-status-check #定时任务\n    cancelGroup: cancel-order #消费组业务逻辑,取消超时未支付订单\n    transGroup: cart-delete #事务消息群组\n    transTopic: order-cart #订单-购物车主题\n    asyncOrderTopic: async-order #异步订单topic\n    asyncOrderGroup: async-order-group #异步下单消息消费\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h3",{attrs:{id:"host配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#host配置"}},[a._v("#")]),a._v(" host配置")]),a._v(" "),s("p",[a._v("为了在部署过程中不频繁的改动配置，源码中将数据库、zk、redis、es、mq等连接地址都使用域名方式")]),a._v(" "),s("p",[a._v("通过host解析到对应的资源中。")]),a._v(" "),s("p",[a._v("本机host配置如下 ，或者配置属于你自己适应的环境")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql/MQ/Redis等服务所在的服务器IP tl.nacos.com tlshopdb.com tlshop.com\n示例：\n192.168.116.128 tl.nacos.com tlshopdb.com tlshop.com\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"sql配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql配置"}},[a._v("#")]),a._v(" SQL配置")]),a._v(" "),s("p",[a._v("在MySQL中新建数据库"),s("code",[a._v("micromall")]),a._v("，将项目Document目录下的micromall.sql导入到MySQL数据库micromall")]),a._v(" "),s("h3",{attrs:{id:"node-js配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-js配置"}},[a._v("#")]),a._v(" Node.js配置")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("nodejs 安装")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://nodejs.org/en/\n选择LTS 版本，直接按照提示安装即可\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("查看是否安装成功：node -v")])]),a._v(" "),s("li",[s("p",[a._v("安装镜像")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("npm install -g cnpm --registry=https://registry.npm.taobao.org\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])]),a._v(" "),s("li",[s("p",[a._v("下载依赖")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cnpm install \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])])]),a._v(" "),s("h2",{attrs:{id:"项目启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目启动"}},[a._v("#")]),a._v(" 项目启动")]),a._v(" "),s("p",[a._v("此电商项目有三个工程所")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-tlmall   # 后端微服务项目\n-mall-admin-web # admin后台小二项目\n-tlmall-front  # 前端用户项目\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"tlmall-front"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlmall-front"}},[a._v("#")]),a._v(" tlmall-front")]),a._v(" "),s("p",[a._v("启动服务：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cnpm run serve\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"mall-admin-web"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mall-admin-web"}},[a._v("#")]),a._v(" mall-admin-web")]),a._v(" "),s("p",[a._v("启动服务：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("npm run dev\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"tuling-mall"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tuling-mall"}},[a._v("#")]),a._v(" tuling-mall")]),a._v(" "),s("p",[s("strong",[a._v("启动顺序：先启动")]),a._v("TulingmallAuthcenterApplication应用，其他顺序没有影响，目前搜索服务还没集成过来，不需要启动")])])}),[],!1,null,null,null);s.default=e.exports}}]);