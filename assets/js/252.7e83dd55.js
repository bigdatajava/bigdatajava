(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{594:function(e,t,s){"use strict";s.r(t);var n=s(1),r=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("U2FsdGVkX1/S7HH5NUrdyVhviiKntn8kGLYFAAQlRC3xVB7AoPgavWInJ/aaQHQb\nd5x6INh2s+yFuIrvMMR1SaU10Bi2lrjjaTBrRtYjK6q6AMbtDwgfoLrTXRKNi8yY\nEg==\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[t("strong",[e._v("1. Spring扩展点")])]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("BeanFactoryPostProcessor")])])]),e._v(" "),t("li",[t("ul",[t("li",[t("strong",[e._v("BeanDefinitionRegistryPostProcessor")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("BeanPostProcessor")])])]),e._v(" "),t("li",[t("ul",[t("li",[t("strong",[e._v("InstantiationAwareBeanPostProcessor")])]),e._v(" "),t("li",[t("strong",[e._v("AbstractAutoProxyCreator")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("@Import")])])]),e._v(" "),t("li",[t("ul",[t("li",[t("strong",[e._v("Impor"),t("strong",[t("strong",[e._v("tBeanDefi")])]),e._v("nitionRegistrar")])]),e._v(" "),t("li",[t("strong",[e._v("ImportSelector")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Aware")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("InitializingBean")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("FactoryBean")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("SmartInitializingSingleton")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("ApplicationListener")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Lifecycle")])])]),e._v(" "),t("li",[t("ul",[t("li",[t("strong",[e._v("SmartLifecycle")])]),e._v(" "),t("li",[t("strong",[e._v("LifecycleProcessor")])])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("HandlerInterceptor")])])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("MethodInterceptor")])])])]),e._v(" "),t("p",[e._v("https://www.processon.com/view/link/5eafa609f346fb177ba8091f")]),e._v(" "),t("p",[t("strong",[e._v("2.")]),e._v(" "),t("strong",[e._v("Spring扩展点应用场景")])]),e._v(" "),t("p",[t("strong",[e._v("2.1 整合Nacos")])]),e._v(" "),t("p",[t("strong",[e._v("思考： 为什么整合Nacos注册中心后，服务启动就会自动注册，Nacos是如何实现自动服务注册的？")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171706002.png",alt:"image-20220623171706002"}})]),e._v(" "),t("p",[t("strong",[e._v("NacosAutoServiceRegistration")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# 对ApplicationListener的扩展\nAbstractAutoServiceRegistration#onApplicationEvent\n# 服务注册\n》NacosServiceRegistry#register\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[e._v("​")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171720271.png",alt:"image-20220623171720271"}})]),e._v(" "),t("p",[e._v("​")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://www.processon.com/view/link/5ea27ca15653bb6efc68eb8c",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[e._v("https://www.processon.com/view/link/5ea27ca15653bb6efc68eb8c")]),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("NacosWatch：")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("#对SmartLifecycle的扩展\nNacosWatch#start\n#订阅服务接收实例更改的事件\n》NamingService#subscribe \n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171729813.png",alt:"image-20220623171729813"}})]),e._v(" "),t("p",[t("strong",[e._v("扩展：")]),e._v(" "),t("strong",[e._v("Eureka Server端上下文的初始化是在SmartLifecycle#start中实现的")])]),e._v(" "),t("p",[t("strong",[e._v("EurekaServerInitializerConfiguration")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171739539.png",alt:"image-20220623171739539"}})]),e._v(" "),t("p",[t("strong",[e._v("2.2 整合Feign")])]),e._v(" "),t("p",[t("strong",[e._v("思考：为什么Feign接口可以通过@Autowired直接注入使用？Feign接口是如何交给Spring管理的？")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('@FeignClient(value = "mall-order",path = "/order")\npublic interface OrderFeignService {\n\n    @RequestMapping("/findOrderByUserId/{userId}")\n    R findOrderByUserId(@PathVariable("userId") Integer userId);\n}\n\n@RestController\n@RequestMapping("/user")\npublic class UserController {\n\n    @Autowired\n    OrderFeignService orderFeignService;\n\n    @RequestMapping(value = "/findOrderByUserId/{id}")\n    public R  findOrderByUserId(@PathVariable("id") Integer id) {\n        //feign调用\n        R result = orderFeignService.findOrderByUserId(id);\n        return result;\n    }\n}\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br")])]),t("p",[t("strong",[e._v("FeignClientsRegistrar")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171751712.png",alt:"image-20220623171751712"}})]),e._v(" "),t("p",[t("strong",[e._v("FeignClientFactorybean")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171759817.png",alt:"image-20220623171759817"}})]),e._v(" "),t("p",[e._v("https://www.processon.com/view/link/5e80ae79e4b03b99653fe42f")]),e._v(" "),t("p",[t("strong",[e._v("2.3 整合Ribbon")])]),e._v(" "),t("p",[t("strong",[e._v("思考：为什么@Bean修饰的RestTemplate加上@LoadBalanced就能实现负载均衡功能？")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("@Bean\n@LoadBalanced\npublic RestTemplate restTemplate() {\n    return new RestTemplate();\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[t("strong",[e._v("LoadBalancerAutoConfiguration")])]),e._v(" "),t("p",[e._v("对SmartInitializingSingleton的扩展，为所有用@LaodBalanced修饰的restTemplate（利用了@Qualifier）绑定实现了负载均衡逻辑的拦截器LoadBalancerInterceptor")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171812275.png",alt:"image-20220623171812275"}})]),e._v(" "),t("p",[t("strong",[e._v("LoadBalancerInterceptor")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171831504.png",alt:"image-20220623171831504"}})]),e._v(" "),t("p",[e._v("https://www.processon.com/view/link/5e7466dce4b027d999bdaddb")]),e._v(" "),t("p",[t("strong",[e._v("2.4 整合sentinel")])]),e._v(" "),t("p",[t("strong",[e._v("AbstractSentinelInterceptor")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# Webmvc接口资源保护入口\nAbstractSentinelInterceptor#preHandle\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171844168.png",alt:"image-20220623171844168"}})]),e._v(" "),t("p",[t("strong",[e._v("SentinelDataSourceHandler")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("#Sentinel持久化读数据源设计，利用了SmartInitializingSingleton扩展点\nSentinelDataSourceHandler#afterSingletonsInstantiated\n# 注册一个FactoryBean类型的数据源 \n》SentinelDataSourceHandler#registerBean\n》》NacosDataSourceFactoryBean#getObject\n# 利用FactoryBean获取到读数据源\n》》new NacosDataSource(properties, groupId, dataId, converter)\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("​")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171905906.png",alt:"image-20220623171905906"}})]),e._v(" "),t("p",[t("strong",[e._v("NacosDataSourceFactoryBean")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171913071.png",alt:"image-20220623171913071"}})]),e._v(" "),t("p",[t("strong",[e._v("2.5 整合seata")])]),e._v(" "),t("p",[t("strong",[e._v("GlobalTransactionScanner")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171925294.png",alt:"image-20220623171925294"}})]),e._v(" "),t("p",[t("strong",[e._v("GlobalTransactionalInterceptor")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/nylg/picture/raw/master/springboot/image-20220623171936094.png",alt:"image-20220623171936094"}})]),e._v(" "),t("p",[t("a",{attrs:{href:"https://www.processon.com/view/link/5f743063e0b34d0711f001d2",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[e._v("https://www.processon.com/view/link/5f743063e0b34d0711f001d2")]),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("3. Nacos配置中心源码分析")])]),e._v(" "),t("p",[e._v("https://www.processon.com/view/link/603f3d2fe401fd641adb51f1")])])}),[],!1,null,null,null);t.default=r.exports}}]);