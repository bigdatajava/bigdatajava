(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{482:function(e,s,n){"use strict";n.r(s);var t=n(1),a=Object(t.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"实现效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现效果"}},[e._v("#")]),e._v(" 实现效果")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190826193052744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaW9mY2hhbw==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),e._v(" "),s("code",[e._v("详情生成文件-见附件")]),s("a",{attrs:{href:"http://download.csdn.net/download/baiofchao/11615628",target:"_blank",rel:"noopener noreferrer"}},[e._v("xls文件"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"技术"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#技术"}},[e._v("#")]),e._v(" 技术")]),e._v(" "),s("p",[e._v("springcloud，POI")]),e._v(" "),s("h2",{attrs:{id:"_1-注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-注意事项"}},[e._v("#")]),e._v(" 1.注意事项")]),e._v(" "),s("p",[e._v("1）设置单元格自适应大小，对中文支持不太好，需要额外设置\n2）注意，createRow指定创建行后，再次重复创建指定行，会导致上次createRow创建的row失效\n示例")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('\t\tHSSFRow row2 = sheet.createRow(4);\t\t//指定创建第三行\n        HSSFCell cell2 = row2.createCell(4);\n        cell2.setCellValue("4");\n\n        //有创建了一次第三行，所以会导致上面的第四行信息没了\n        HSSFRow row3 = sheet.createRow(4);\n        HSSFCell cell3 = row3.createCell(3);\n        cell3.setCellValue("3");\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("h2",{attrs:{id:"代码示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码示例"}},[e._v("#")]),e._v(" 代码示例")]),e._v(" "),s("p",[e._v("Resource：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(' @PostMapping("/quote-lines/_export")\n    public ResponseEntity<byte[]> exportQuoteLine(@RequestBody List<String> quoteLineIdList) throws IOException {\n\n        List<QuoteLineDTO> quoteLineDTOList = quoteLineService.findQuoteLineByIds(quoteLineIdList);\n        if(CollectionUtils.isEmpty(quoteLineDTOList)){\n            log.info("exportQuoteLine->The request parameter is empty");\n            return null;\n        }\n\n        List<QuoteLineDTO> quoteLineDTOS = new ArrayList<>();\n        int h = 0;\n        for (int i = 0; i < quoteLineDTOList.size() && h < 30; i++) {\n            if (org.apache.commons.lang3.StringUtils.isNotBlank(quoteLineDTOList.get(i).getProductType()) && quoteLineDTOList.get(i).getProductType().equalsIgnoreCase(QuoteEnum.CTO.getName())) {\n                quoteLineDTOS.add(h, quoteLineDTOList.get(i));\n                h++;\n            }\n        }\n\n        if (CollectionUtils.isEmpty(quoteLineDTOS)) {\n            log.info("exportQuoteLine->The request parameter(CTO-QuoteLine) is empty");\n            return null;\n        }\n        String responseFileName = null;\n        Quote quote = quoteService.findOne(quoteLineDTOS.get(0).getQuoteId()).get();\n        if (quote.getBusinessUnit().equalsIgnoreCase(QuoteEnum.PCSD.getName())) {\n            responseFileName = ExportQuoteLineEnum.PCSD_FILENAME.getName();\n        } else {\n            responseFileName = ExportQuoteLineEnum.DCG_FILENAME.getName();\n        }\n\n        byte[] bytes = quoteLineService.exportQuoteLineByCTO(quoteLineDTOS, quote);\n\n        HttpHeaders headers = new HttpHeaders();\n        headers.set("file-name", responseFileName);\n        headers.setContentDispositionFormData("attachment", responseFileName);\n        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);\n        //new FileOutputStream("/home/111.xls").write(bytes, 0, bytes.length)\n        return new ResponseEntity<>(\n            bytes,\n            headers,\n            HttpStatus.CREATED\n        );\n\n\n    }\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br"),s("span",{staticClass:"line-number"},[e._v("33")]),s("br"),s("span",{staticClass:"line-number"},[e._v("34")]),s("br"),s("span",{staticClass:"line-number"},[e._v("35")]),s("br"),s("span",{staticClass:"line-number"},[e._v("36")]),s("br"),s("span",{staticClass:"line-number"},[e._v("37")]),s("br"),s("span",{staticClass:"line-number"},[e._v("38")]),s("br"),s("span",{staticClass:"line-number"},[e._v("39")]),s("br"),s("span",{staticClass:"line-number"},[e._v("40")]),s("br"),s("span",{staticClass:"line-number"},[e._v("41")]),s("br"),s("span",{staticClass:"line-number"},[e._v("42")]),s("br"),s("span",{staticClass:"line-number"},[e._v("43")]),s("br"),s("span",{staticClass:"line-number"},[e._v("44")]),s("br"),s("span",{staticClass:"line-number"},[e._v("45")]),s("br")])]),s("p",[e._v("service：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('\n   public byte[] exportQuoteLineByCTO(List<QuoteLineDTO> quoteLineDTOList, Quote quote) throws IOException {\n\n        HSSFWorkbook workbook = new HSSFWorkbook();\n        setHeaderCellStyle(workbook);\n        if (quote.getBusinessUnit().equalsIgnoreCase(QuoteEnum.PCSD.getName())) {\n\n            HSSFSheet sheet = workbook.createSheet(QuoteEnum.PCSD.getName());\n\n            sheet.setDefaultRowHeight((short) (2 * 256));\n            sheet.setDefaultColumnWidth(17);\n\n            //max row\n            int maxRow = 0;\n            for (int g = 0; g < quoteLineDTOList.size(); g++) {\n                //There are no database fields in dto->com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "XXX"\n                List<CvPairsDTO> cvPairsDTOList = new ObjectMapper().readValue(quoteLineDTOList.get(g).getConfiguration(), new TypeReference<List<CvPairsDTO>>() {\n                });\n                if (cvPairsDTOList.size() > maxRow) {\n                    maxRow = cvPairsDTOList.size();\n                }\n            }\n\n            List<HSSFRow> rowList = Arrays.asList(new HSSFRow[maxRow + 2]);\n            setHeaderStyle(sheet, quoteLineDTOList, rowList, maxRow);\n            setCellData(sheet, quoteLineDTOList, rowList);\n            return FileToByte.byteFromFile(workbook);\n\n        } else {//dcg\n\n            HSSFSheet sheet = workbook.createSheet(QuoteEnum.DCG.getName());\n\n            int number = 2;\n            for (int i = 0; i < quoteLineDTOList.size(); i++) {\n                sheet.createRow(number - 2).createCell(0).setCellValue(ExportQuoteLineEnum.DCG_FIRSTROW_ONE.getName());\n                HSSFRow sheetRow = sheet.createRow(number - 1);\n                sheetRow.createCell(0).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_ONE.getName());\n                sheetRow.createCell(1).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_TWO.getName());\n                sheetRow.createCell(2).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_THREE.getName());\n                sheetRow.createCell(3).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_FOUR.getName());\n                sheetRow.createCell(4).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_FIVE.getName());\n                sheetRow.createCell(5).setCellValue(ExportQuoteLineEnum.DCG_SECONDROW_SIX.getName());\n\n                List<FeatureCodeConfigurationDTO> quoteConfigurationDTOList = new ObjectMapper().readValue(quoteLineDTOList.get(i).getConfiguration(), new TypeReference<List<FeatureCodeConfigurationDTO>>() {\n                });\n                for (int j = 0; j < quoteConfigurationDTOList.size(); j++) {\n                    HSSFRow row = sheet.createRow(number + j);\n                    row.createCell(0).setCellValue(quoteLineDTOList.get(i).getSolutionId());\n                    row.createCell(1).setCellValue(quoteLineDTOList.get(i).getProductNumber());\n                    row.createCell(3).setCellValue(quoteConfigurationDTOList.get(j).getFeatureCode());\n                    row.createCell(4).setCellValue(quoteConfigurationDTOList.get(j).getDescription());\n                    row.createCell(5).setCellValue(quoteConfigurationDTOList.get(j).getQuantity());\n                }\n                number += quoteConfigurationDTOList.size() + 2;\n            }\n            return FileToByte.byteFromFile(workbook);\n        }\n    }\n\n\n    //Set Header Style\n    public void setHeaderStyle(HSSFSheet sheet, List<QuoteLineDTO> quoteLineDTOList, List<HSSFRow> rowList, int maxRow) {\n\n        HSSFRow row0 = sheet.createRow(0);\n        HSSFRow row1 = sheet.createRow(1);\n\n        for (int i = 0; i < quoteLineDTOList.size(); i++) {\n            //Set the first line of the head\n            HSSFCell cell11 = row0.createCell(4 * i);\n            cell11.setCellValue(ExportQuoteLineEnum.PCSD_FIRSTROW_ONE.getName());\n            cell11.setCellStyle(cellStyle);\n            HSSFCell cell12 = row0.createCell(4 * i + 1);\n            cell12.setCellValue(quoteLineDTOList.get(i).getProductNumber());\n            cell12.setCellStyle(cellStyle);\n            //Set the second line of the head\n            HSSFCell cell21 = row1.createCell(4 * i);\n            cell21.setCellValue(ExportQuoteLineEnum.PCSD_SECONDROW_ONE.getName());\n            cell21.setCellStyle(cellStyle);\n            HSSFCell cell22 = row1.createCell(4 * i + 1);\n            cell22.setCellValue(ExportQuoteLineEnum.PCSD_SECONDROW_TWO.getName());\n            cell22.setCellStyle(cellStyle);\n            HSSFCell cell23 = row1.createCell(4 * i + 2);\n            cell23.setCellValue(ExportQuoteLineEnum.PCSD_SECONDROW_THREE.getName());\n            cell23.setCellStyle(cellStyle);\n        }\n\n        //other row\n        for (int i = 0; i < maxRow; i++) {\n            rowList.set(i + 2, sheet.createRow(i + 2));\n        }\n\n    }\n\n    //Set data\n    public void setCellData(HSSFSheet sheet, List<QuoteLineDTO> quoteLineDTOList, List<HSSFRow> rowList) throws IOException {\n\n        for (int i = 0; i < quoteLineDTOList.size(); i++) {\n            List<CvPairsDTO> cvPairsDTOList = new ObjectMapper().readValue(quoteLineDTOList.get(i).getConfiguration(), new TypeReference<List<CvPairsDTO>>() {\n            });\n            //other row is data\n            for (int j = 0; j < cvPairsDTOList.size(); j++) {\n                rowList.get(j + 2).createCell(4 * i).setCellValue(cvPairsDTOList.get(j).getValueDescription());\n            }\n        }\n\n    }\n\n    //set cell style\n    public void setHeaderCellStyle(HSSFWorkbook workbook) {\n        HSSFFont font = workbook.createFont();\n        font.setBold(true);\n        cellStyle = workbook.createCellStyle();\n        cellStyle.setFont(font);\n\n    }\n    \nprivate static HSSFCellStyle cellStyle = null;\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br"),s("span",{staticClass:"line-number"},[e._v("33")]),s("br"),s("span",{staticClass:"line-number"},[e._v("34")]),s("br"),s("span",{staticClass:"line-number"},[e._v("35")]),s("br"),s("span",{staticClass:"line-number"},[e._v("36")]),s("br"),s("span",{staticClass:"line-number"},[e._v("37")]),s("br"),s("span",{staticClass:"line-number"},[e._v("38")]),s("br"),s("span",{staticClass:"line-number"},[e._v("39")]),s("br"),s("span",{staticClass:"line-number"},[e._v("40")]),s("br"),s("span",{staticClass:"line-number"},[e._v("41")]),s("br"),s("span",{staticClass:"line-number"},[e._v("42")]),s("br"),s("span",{staticClass:"line-number"},[e._v("43")]),s("br"),s("span",{staticClass:"line-number"},[e._v("44")]),s("br"),s("span",{staticClass:"line-number"},[e._v("45")]),s("br"),s("span",{staticClass:"line-number"},[e._v("46")]),s("br"),s("span",{staticClass:"line-number"},[e._v("47")]),s("br"),s("span",{staticClass:"line-number"},[e._v("48")]),s("br"),s("span",{staticClass:"line-number"},[e._v("49")]),s("br"),s("span",{staticClass:"line-number"},[e._v("50")]),s("br"),s("span",{staticClass:"line-number"},[e._v("51")]),s("br"),s("span",{staticClass:"line-number"},[e._v("52")]),s("br"),s("span",{staticClass:"line-number"},[e._v("53")]),s("br"),s("span",{staticClass:"line-number"},[e._v("54")]),s("br"),s("span",{staticClass:"line-number"},[e._v("55")]),s("br"),s("span",{staticClass:"line-number"},[e._v("56")]),s("br"),s("span",{staticClass:"line-number"},[e._v("57")]),s("br"),s("span",{staticClass:"line-number"},[e._v("58")]),s("br"),s("span",{staticClass:"line-number"},[e._v("59")]),s("br"),s("span",{staticClass:"line-number"},[e._v("60")]),s("br"),s("span",{staticClass:"line-number"},[e._v("61")]),s("br"),s("span",{staticClass:"line-number"},[e._v("62")]),s("br"),s("span",{staticClass:"line-number"},[e._v("63")]),s("br"),s("span",{staticClass:"line-number"},[e._v("64")]),s("br"),s("span",{staticClass:"line-number"},[e._v("65")]),s("br"),s("span",{staticClass:"line-number"},[e._v("66")]),s("br"),s("span",{staticClass:"line-number"},[e._v("67")]),s("br"),s("span",{staticClass:"line-number"},[e._v("68")]),s("br"),s("span",{staticClass:"line-number"},[e._v("69")]),s("br"),s("span",{staticClass:"line-number"},[e._v("70")]),s("br"),s("span",{staticClass:"line-number"},[e._v("71")]),s("br"),s("span",{staticClass:"line-number"},[e._v("72")]),s("br"),s("span",{staticClass:"line-number"},[e._v("73")]),s("br"),s("span",{staticClass:"line-number"},[e._v("74")]),s("br"),s("span",{staticClass:"line-number"},[e._v("75")]),s("br"),s("span",{staticClass:"line-number"},[e._v("76")]),s("br"),s("span",{staticClass:"line-number"},[e._v("77")]),s("br"),s("span",{staticClass:"line-number"},[e._v("78")]),s("br"),s("span",{staticClass:"line-number"},[e._v("79")]),s("br"),s("span",{staticClass:"line-number"},[e._v("80")]),s("br"),s("span",{staticClass:"line-number"},[e._v("81")]),s("br"),s("span",{staticClass:"line-number"},[e._v("82")]),s("br"),s("span",{staticClass:"line-number"},[e._v("83")]),s("br"),s("span",{staticClass:"line-number"},[e._v("84")]),s("br"),s("span",{staticClass:"line-number"},[e._v("85")]),s("br"),s("span",{staticClass:"line-number"},[e._v("86")]),s("br"),s("span",{staticClass:"line-number"},[e._v("87")]),s("br"),s("span",{staticClass:"line-number"},[e._v("88")]),s("br"),s("span",{staticClass:"line-number"},[e._v("89")]),s("br"),s("span",{staticClass:"line-number"},[e._v("90")]),s("br"),s("span",{staticClass:"line-number"},[e._v("91")]),s("br"),s("span",{staticClass:"line-number"},[e._v("92")]),s("br"),s("span",{staticClass:"line-number"},[e._v("93")]),s("br"),s("span",{staticClass:"line-number"},[e._v("94")]),s("br"),s("span",{staticClass:"line-number"},[e._v("95")]),s("br"),s("span",{staticClass:"line-number"},[e._v("96")]),s("br"),s("span",{staticClass:"line-number"},[e._v("97")]),s("br"),s("span",{staticClass:"line-number"},[e._v("98")]),s("br"),s("span",{staticClass:"line-number"},[e._v("99")]),s("br"),s("span",{staticClass:"line-number"},[e._v("100")]),s("br"),s("span",{staticClass:"line-number"},[e._v("101")]),s("br"),s("span",{staticClass:"line-number"},[e._v("102")]),s("br"),s("span",{staticClass:"line-number"},[e._v("103")]),s("br"),s("span",{staticClass:"line-number"},[e._v("104")]),s("br"),s("span",{staticClass:"line-number"},[e._v("105")]),s("br"),s("span",{staticClass:"line-number"},[e._v("106")]),s("br"),s("span",{staticClass:"line-number"},[e._v("107")]),s("br"),s("span",{staticClass:"line-number"},[e._v("108")]),s("br"),s("span",{staticClass:"line-number"},[e._v("109")]),s("br"),s("span",{staticClass:"line-number"},[e._v("110")]),s("br"),s("span",{staticClass:"line-number"},[e._v("111")]),s("br"),s("span",{staticClass:"line-number"},[e._v("112")]),s("br"),s("span",{staticClass:"line-number"},[e._v("113")]),s("br"),s("span",{staticClass:"line-number"},[e._v("114")]),s("br"),s("span",{staticClass:"line-number"},[e._v("115")]),s("br"),s("span",{staticClass:"line-number"},[e._v("116")]),s("br"),s("span",{staticClass:"line-number"},[e._v("117")]),s("br")])]),s("p",[e._v("POI好的链接")])])}),[],!1,null,null,null);s.default=a.exports}}]);