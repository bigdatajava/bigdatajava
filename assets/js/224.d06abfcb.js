(window.webpackJsonp=window.webpackJsonp||[]).push([[224],{589:function(s,n,e){"use strict";e.r(n);var a=e(5),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("U2FsdGVkX19v/d7DUCweIs4WTCsBcm/2Hx6eM5F1t0Yi4BQF9QmEdfj7VTemyCjU\nRw8U5xxNjOUh7q01ojk1ik2u0XDkI46luOeTkDXzJyy+DS4ofHJCwPK/HLPIcEfP\nTw==\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("MyBatis是一个持久层的ORM框架，使用简单，学习成本较低。可以执行自己手写的SQL语句，比较灵活。但是MyBatis的自动化程度不高，移植性也不高，有时从一个数据库迁移到另外一个数据库的时候需要自己修改配置，所以称只为半自动ORM框架")]),s._v(" "),n("p",[s._v("MyBaits基础应用：")]),s._v(" "),n("p",[s._v("文档：MyBatis")]),s._v(" "),n("p",[s._v("链接：http://note.youdao.com/noteshare?id=5d41fd41d970f1af9185ea2ec0647b64")]),s._v(" "),n("p",[n("strong",[s._v("传统JDBC和Mybatis相比的弊病")])]),s._v(" "),n("p",[s._v("传统JDBC")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('@Test\npublic  void test() throws SQLException {\n    Connection conn=null;\n    PreparedStatement pstmt=null;\n    try {\n        // 1.加载驱动\n        Class.forName("com.mysql.jdbc.Driver");\n\n        // 2.创建连接\n        conn= DriverManager.\n                getConnection("jdbc:mysql://localhost:3306/mybatis_example", "root", "123456");\n\n\n        // SQL语句\n        String sql="select id,user_name,create_time from t_user where id=?";\n\n        // 获得sql执行者\n        pstmt=conn.prepareStatement(sql);\n        pstmt.setInt(1,1);\n\n        // 执行查询\n        //ResultSet rs= pstmt.executeQuery();\n        pstmt.execute();\n        ResultSet rs= pstmt.getResultSet();\n\n        rs.next();\n        User user =new User();\n        user.setId(rs.getLong("id"));\n        user.setUserName(rs.getString("user_name"));\n        user.setCreateTime(rs.getDate("create_time"));\n        System.out.println(user.toString());\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    finally{\n        // 关闭资源\n        try {\n            if(conn!=null){\n                conn.close();\n            }\n            if(pstmt!=null){\n                pstmt.close();\n            }\n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br")])]),n("p",[s._v("传统JDBC的问题如下：")]),s._v(" "),n("p",[s._v("1.数据库连接创建，释放频繁造成西戎资源的浪费，从而影响系统性能，使用数据库连接池可以解决问题。")]),s._v(" "),n("p",[s._v("2.sql语句在代码中硬编码，造成代码的不已维护，实际应用中sql的变化可能较大，sql代码和java代码没有分离开来维护不方便。")]),s._v(" "),n("p",[s._v("3.使用preparedStatement向有占位符传递参数存在硬编码问题因为sql中的where子句的条件不确定，同样是修改不方便/")]),s._v(" "),n("p",[s._v("4.对结果集中解析存在硬编码问题，sql的变化导致解析代码的变化，系统维护不方便。")]),s._v(" "),n("p",[n("strong",[s._v("mybatis对传统的JDBC的解决方案")])]),s._v(" "),n("p",[s._v("1、数据库连接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库连接池可解决此问题。")]),s._v(" "),n("p",[s._v("解决：在SqlMapConfig.xml中配置数据连接池，使用连接池管理数据库链接。")]),s._v(" "),n("p",[s._v("2、Sql语句写在代码中造成代码不易维护，实际应用sql变化的可能较大，sql变动需要改变java代码。")]),s._v(" "),n("p",[s._v("解决：将Sql语句配置在XXXXmapper.xml文件中与java代码分离。")]),s._v(" "),n("p",[s._v("3、向sql语句传参数麻烦，因为sql语句的where条件不一定，可能多也可能少，占位符需要和参数一一对应。")]),s._v(" "),n("p",[s._v("解决：Mybatis自动将java对象映射至sql语句，通过statement中的parameterType定义输入参数的类型。")]),s._v(" "),n("p",[s._v("4、对结果集解析麻烦，sql变化导致解析代码变化，且解析前需要遍历，如果能将数据库记录封装成pojo对象解析比较方便。")]),s._v(" "),n("p",[s._v("解决：Mybatis自动将sql执行结果映射至java对象，通过statement中的resultType定义输出结果的类型。")]),s._v(" "),n("p",[n("strong",[s._v("Mybaits整体体系图")])]),s._v(" "),n("p",[s._v("​")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/spring/image-20220618095625636.png",alt:"image-20220618095625636"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/spring/image-20220618095640224.png",alt:"image-20220618095640224"}})]),s._v(" "),n("p",[s._v("一个Mybatis最简单的使用列子如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('public class App {\n    public static void main(String[] args) {\n        String resource = "mybatis-config.xml";\n        Reader reader;\n        try {\n            //将XML配置文件构建为Configuration配置类\n            reader = Resources.getResourceAsReader(resource);\n            // 通过加载配置文件流构建一个SqlSessionFactory  DefaultSqlSessionFactory\n            SqlSessionFactory sqlMapper = new SqlSessionFactoryBuilder().build(reader);\n            // 数据源 执行器  DefaultSqlSession\n            SqlSession session = sqlMapper.openSession();\n            try {\n                // 执行查询 底层执行jdbc\n                //User user = (User)session.selectOne("com.tuling.mapper.selectById", 1);\n\n                UserMapper mapper = session.getMapper(UserMapper.class);\n                System.out.println(mapper.getClass());\n                User user = mapper.selectById(1L);\n                System.out.println(user.getUserName());\n            } catch (Exception e) {\n                e.printStackTrace();\n            }finally {\n                session.close();\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[s._v("总结下就是分为下面四个步骤：")]),s._v(" "),n("ul",[n("li",[s._v("从配置文件（通常是XML文件）得到SessionFactory;")]),s._v(" "),n("li",[s._v("从SessionFactory得到SqlSession；")]),s._v(" "),n("li",[s._v("通过SqlSession进行CRUD和事务的操作；")]),s._v(" "),n("li",[s._v("执行完相关操作之后关闭Session。")])]),s._v(" "),n("p",[n("strong",[s._v("MyBatis 源码编译")])]),s._v(" "),n("p",[s._v("MyBatis的源码编译比较简单， 随便在网上找一篇博客即可，在这里不多说")]),s._v(" "),n("p",[s._v("https://www.cnblogs.com/mokingone/p/9108999.html")]),s._v(" "),n("p",[s._v("如果希望在spring源码中引入你自己的这份源码，可以做如下操作")]),s._v(" "),n("ol",[n("li",[s._v("修改你mybatis源码的pom的 这样可以和官方的区分开来")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<version>3.5.3-xsls</version>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",[n("li",[n("p",[s._v("这样你在spring源码中就可以引入这份mybatis源码了.")])]),s._v(" "),n("li",[n("ol",[n("li",[s._v("如果引入mybatis-spring 同样需要做1、3步骤")])])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('compile("org.mybatis:mybatis-spring:2.0.3-xsls")  \ncompile("org.mybatis:mybatis:3.5.3-xsls")\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",[n("li",[s._v("当然，如果你想在spring这边看到你mybatis源码相关的注释，还得在mybatis源码的pom里面加入plugin,使它生成 jar 的同时 生成 sources 包")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<plugin>\n  <artifactId>maven-source-plugin</artifactId>\n  <version>3.0.1</version>\n  <configuration>\n    <attach>true</attach>\n  </configuration>\n  <executions>\n    <execution>\n      <phase>compile</phase>\n      <goals>\n        <goal>jar</goal>\n      </goals>\n    </execution>\n  </executions>\n</plugin>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[n("strong",[s._v("也可以直接用徐庶老师的mybatis源码：")])]),s._v(" "),n("p",[s._v("git地址：https://gitee.com/tuling_xushu/mybatis-3-5.3.x.git")]),s._v(" "),n("p",[n("strong",[s._v("启动流程分析")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('String resource = "mybatis-config.xml";\n//将XML配置文件构建为Configuration配置类\nreader = Resources.getResourceAsReader(resource);\n// 通过加载配置文件流构建一个SqlSessionFactory  DefaultSqlSessionFactory\nSqlSessionFactory sqlMapper = new SqlSessionFactoryBuilder().build(reader);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[s._v("通过上面代码发现，创建SqlSessionFactory的代码在SqlSessionFactoryBuilder中，进去一探究竟：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('//整个过程就是将配置文件解析成Configration对象，然后创建SqlSessionFactory的过程\n//Configuration是SqlSessionFactory的一个内部属性\npublic SqlSessionFactory build(InputStream inputStream, String environment, Properties properties) {\n    try {\n      XMLConfigBuilder parser = new XMLConfigBuilder(inputStream, environment, properties);\n      return build(parser.parse());\n    } catch (Exception e) {\n      throw ExceptionFactory.wrapException("Error building SqlSession.", e);\n    } finally {\n      ErrorContext.instance().reset();\n      try {\n        inputStream.close();\n      } catch (IOException e) {\n        // Intentionally ignore. Prefer previous error.\n      }\n    }\n  }\n    \n  public SqlSessionFactory build(Configuration config) {\n    return new DefaultSqlSessionFactory(config);\n  }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("下面我们看下解析配置文件过程中的一些细节。")]),s._v(" "),n("p",[s._v("先给出一个配置文件的列子：")]),s._v(" "),n("p",[s._v("Copy")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE configuration\n        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n    \x3c!--SqlSessionFactoryBuilder中配置的配置文件的优先级最高；config.properties配置文件的优先级次之；properties标签中的配置优先级最低 --\x3e\n    <properties resource="org/mybatis/example/config.properties">\n      <property name="username" value="dev_user"/>\n      <property name="password" value="F2Fa3!33TYyg"/>\n    </properties>\n\n    \x3c!--一些重要的全局配置--\x3e\n    <settings>\n    <setting name="cacheEnabled" value="true"/>\n    \x3c!--<setting name="lazyLoadingEnabled" value="true"/>--\x3e\n    \x3c!--<setting name="multipleResultSetsEnabled" value="true"/>--\x3e\n    \x3c!--<setting name="useColumnLabel" value="true"/>--\x3e\n    \x3c!--<setting name="useGeneratedKeys" value="false"/>--\x3e\n    \x3c!--<setting name="autoMappingBehavior" value="PARTIAL"/>--\x3e\n    \x3c!--<setting name="autoMappingUnknownColumnBehavior" value="WARNING"/>--\x3e\n    \x3c!--<setting name="defaultExecutorType" value="SIMPLE"/>--\x3e\n    \x3c!--<setting name="defaultStatementTimeout" value="25"/>--\x3e\n    \x3c!--<setting name="defaultFetchSize" value="100"/>--\x3e\n    \x3c!--<setting name="safeRowBoundsEnabled" value="false"/>--\x3e\n    \x3c!--<setting name="mapUnderscoreToCamelCase" value="false"/>--\x3e\n    \x3c!--<setting name="localCacheScope" value="STATEMENT"/>--\x3e\n    \x3c!--<setting name="jdbcTypeForNull" value="OTHER"/>--\x3e\n    \x3c!--<setting name="lazyLoadTriggerMethods" value="equals,clone,hashCode,toString"/>--\x3e\n    \x3c!--<setting name="logImpl" value="STDOUT_LOGGING" />--\x3e\n    </settings>\n\n    <typeAliases>\n\n    </typeAliases>\n\n    <plugins>\n        <plugin interceptor="com.github.pagehelper.PageInterceptor">\n            \x3c!--默认值为 false，当该参数设置为 true 时，如果 pageSize=0 或者 RowBounds.limit = 0 就会查询出全部的结果--\x3e\n            \x3c!--如果某些查询数据量非常大，不应该允许查出所有数据--\x3e\n            <property name="pageSizeZero" value="true"/>\n        </plugin>\n    </plugins>\n\n    <environments default="development">\n        <environment id="development">\n            <transactionManager type="JDBC"/>\n            <dataSource type="POOLED">\n                <property name="driver" value="com.mysql.jdbc.Driver"/>\n                <property name="url" value="jdbc:mysql://10.59.97.10:3308/windty"/>\n                <property name="username" value="windty_opr"/>\n                <property name="password" value="windty!234"/>\n            </dataSource>\n        </environment>\n    </environments>\n\n    <databaseIdProvider type="DB_VENDOR">\n        <property name="MySQL" value="mysql" />\n        <property name="Oracle" value="oracle" />\n    </databaseIdProvider>\n\n    <mappers>\n        \x3c!--这边可以使用package和resource两种方式加载mapper--\x3e\n        \x3c!--<package name="包名"/>--\x3e\n        \x3c!--<mapper resource="./mappers/SysUserMapper.xml"/>--\x3e\n        <mapper resource="./mappers/CbondissuerMapper.xml"/>\n    </mappers>\n\n</configuration>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br")])]),n("p",[s._v("​")]),s._v(" "),n("p",[s._v("下面是解析配置文件的核心方法：")]),s._v(" "),n("p",[s._v("Copy")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('private void parseConfiguration(XNode root) {\n    try {\n      //issue #117 read properties first\n      //解析properties标签，并set到Configration对象中\n      //在properties配置属性后，在Mybatis的配置文件中就可以使用${key}的形式使用了。\n      propertiesElement(root.evalNode("properties"));\n      \n      //解析setting标签的配置\n      Properties settings = settingsAsProperties(root.evalNode("settings"));\n      //添加vfs的自定义实现，这个功能不怎么用\n      loadCustomVfs(settings);\n        \n      //配置类的别名，配置后就可以用别名来替代全限定名\n      //mybatis默认设置了很多别名，参考附录部分\n      typeAliasesElement(root.evalNode("typeAliases"));\n        \n      //解析拦截器和拦截器的属性，set到Configration的interceptorChain中\n      //MyBatis 允许你在已映射语句执行过程中的某一点进行拦截调用。默认情况下，MyBatis 允许使用插件来拦截的方法调用包括：\n      //Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)\n        //ParameterHandler (getParameterObject, setParameters)\n        //ResultSetHandler (handleResultSets, handleOutputParameters)\n        //StatementHandler (prepare, parameterize, batch, update, query)\n      pluginElement(root.evalNode("plugins"));\n      \n      //Mybatis创建对象是会使用objectFactory来创建对象，一般情况下不会自己配置这个objectFactory，使用系统默认的objectFactory就好了\n      objectFactoryElement(root.evalNode("objectFactory"));\n      objectWrapperFactoryElement(root.evalNode("objectWrapperFactory"));\n      reflectorFactoryElement(root.evalNode("reflectorFactory"));\n       \n      //设置在setting标签中配置的配置\n      settingsElement(settings);\n   \n      //解析环境信息，包括事物管理器和数据源，SqlSessionFactoryBuilder在解析时需要指定环境id，如果不指定的话，会选择默认的环境；\n      //最后将这些信息set到Configration的Environment属性里面\n      environmentsElement(root.evalNode("environments"));\n        \n      //\n      databaseIdProviderElement(root.evalNode("databaseIdProvider"));\n        \n      //无论是 MyBatis 在预处理语句（PreparedStatement）中设置一个参数时，还是从结果集中取出一个值时， 都会用类型处理器将获取的值以合适的方式转换成 Java 类型。解析typeHandler。\n      typeHandlerElement(root.evalNode("typeHandlers"));\n      //解析Mapper\n      mapperElement(root.evalNode("mappers"));\n    } catch (Exception e) {\n      throw new BuilderException("Error parsing SQL Mapper Configuration. Cause: " + e, e);\n    }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://404500.oss-cn-beijing.aliyuncs.com/picture/spring/image-20220618100004801.png",alt:"image-20220618100004801"}})]),s._v(" "),n("p",[s._v("上面解析流程结束后会生成一个Configration对象，包含所有配置信息，然后会创建一个SqlSessionFactory对象，这个对象包含了Configration对象。")]),s._v(" "),n("p",[n("strong",[s._v("简单总结")])]),s._v(" "),n("p",[s._v("对于MyBatis启动的流程（获取SqlSession的过程）这边简单总结下：")]),s._v(" "),n("ul",[n("li",[s._v("SqlSessionFactoryBuilder解析配置文件，包括属性配置、别名配置、拦截器配置、环境（数据源和事务管理器）、Mapper配置等；解析完这些配置后会生成一个Configration对象，这个对象中包含了MyBatis需要的所有配置，然后会用这个Configration对象创建一个SqlSessionFactory对象，这个对象中包含了Configration对象；")])]),s._v(" "),n("p",[s._v("这里解析的东西比较多，大致概况：会把所有的信息都解析到Configration对象中，比较简单不多介绍。简单介绍一下：")]),s._v(" "),n("p",[n("strong",[s._v("文档：MyBatis的二级缓存原理分析（请暂时关注解析缓存内容）")])]),s._v(" "),n("p",[s._v("链接：http://note.youdao.com/noteshare?id=b97d399a65e31008fef704164d24c784&sub=wcp1596698664968348")]),s._v(" "),n("p",[n("strong",[s._v("文档：Mybatis解析动态sql原理分析")])]),s._v(" "),n("p",[s._v("链接：http://note.youdao.com/noteshare?id=8b076e28061434f6693d99401d3ed400&sub=D948A34AA06045AEB7A01733A98A4C06")])])}),[],!1,null,null,null);n.default=t.exports}}]);