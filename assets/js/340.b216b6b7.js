(window.webpackJsonp=window.webpackJsonp||[]).push([[340],{706:function(e,t,a){"use strict";a.r(t);var r=a(5),s=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"jetty6-1-9升级到jetty-9-4-53-v20231009-调研过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jetty6-1-9升级到jetty-9-4-53-v20231009-调研过程"}},[e._v("#")]),e._v(" jetty6.1.9升级到jetty-9.4.53.v20231009-调研过程")]),e._v(" "),t("h2",{attrs:{id:"_1-包目录差异-代码改动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-包目录差异-代码改动"}},[e._v("#")]),e._v(" 1. 包目录差异（代码改动）")]),e._v(" "),t("p",[e._v('Jetty 6 中的类库包名通常是以 "org.mortbay" 开头的。这是因为 Jetty 在版本 6 之前由 Mort Bay Consulting 公司开发和维护；')]),e._v(" "),t("p",[e._v('从 Jetty 7 开始，Jetty 的包名发生了变化，更改为了 "org.eclipse.jetty"，反映了 Jetty 项目转移到 Eclipse Foundation 的变化；')]),e._v(" "),t("h2",{attrs:{id:"_2-依赖组件版本差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-依赖组件版本差异"}},[e._v("#")]),e._v(" 2. 依赖组件版本差异")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("JettyVersion")]),e._v(" "),t("th",[e._v("Servlet")]),e._v(" "),t("th",[e._v("License")]),e._v(" "),t("th",[e._v("Java")]),e._v(" "),t("th",[e._v("JSP")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("12.0.x")]),e._v(" "),t("td",[e._v("6.0, 5.0, 4.0, 3.1")]),e._v(" "),t("td",[e._v("JakartaEE 10/jakartaee.servlet.*    JakartaEE 9/jakartaee.servlet.*  JakartaEE 8/javax.servlet.*")]),e._v(" "),t("td",[e._v("17+")]),e._v(" "),t("td",[e._v("https://eclipse.dev/jetty/documentation/jetty-9/index.html")])]),e._v(" "),t("tr",[t("td",[e._v("11.0.x")]),e._v(" "),t("td",[e._v("5.0")]),e._v(" "),t("td",[e._v("JakartaEE 9/jakartaee.servlet.*")]),e._v(" "),t("td",[e._v("11+")]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("10.0.x")]),e._v(" "),t("td",[e._v("4.0")]),e._v(" "),t("td",[e._v("JakartaEE 8/javax.servlet.*")]),e._v(" "),t("td",[e._v("11+")]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("9.4.x")]),e._v(" "),t("td",[e._v("3.1")]),e._v(" "),t("td",[e._v("JavaEE 8/javax.servlet.*")]),e._v(" "),t("td",[e._v("Java 8")]),e._v(" "),t("td")]),e._v(" "),t("tr",[t("td",[e._v("6.1.9")]),e._v(" "),t("td",[e._v("2.5")]),e._v(" "),t("td"),e._v(" "),t("td"),e._v(" "),t("td")])])]),e._v(" "),t("h2",{attrs:{id:"_3-版本jar依赖差异-改动后需要验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-版本jar依赖差异-改动后需要验证"}},[e._v("#")]),e._v(" 3.版本jar依赖差异（改动后需要验证）")]),e._v(" "),t("p",[e._v("jetty6和9依赖的jar差异巨大，目前粗略运行，jar包差异如下：")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("jetty6-ALGO依赖jar")]),e._v(" "),t("th",[e._v("jetty9-ALGO依赖jar")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("jetty-6.1.9.jar")]),e._v(" "),t("td",[e._v("jetty-http-9.4.53.v20231009")])]),e._v(" "),t("tr",[t("td",[e._v("jetty-util-6.1.9.jar")]),e._v(" "),t("td",[e._v("jetty-io-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td",[e._v("jetty-xbean-6.1.9.jar")]),e._v(" "),t("td",[e._v("jetty-security-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jetty-server-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jetty-servlet-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jetty-util-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jetty-webapp-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jetty-xml-9.4.53.v20231009.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("servlet-api-3.1.jar")])]),e._v(" "),t("tr",[t("td"),e._v(" "),t("td",[e._v("jsp相关的四个jar")])])])]),e._v(" "),t("h2",{attrs:{id:"_4-类变化差异-代码改动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-类变化差异-代码改动"}},[e._v("#")]),e._v(" 4. 类变化差异（代码改动）")]),e._v(" "),t("h3",{attrs:{id:"selectchannelconnector-连接差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#selectchannelconnector-连接差异"}},[e._v("#")]),e._v(" SelectChannelConnector -连接差异")]),e._v(" "),t("p",[e._v("在 Jetty 6 中使用的 SelectChannelConnector 在 Jetty 9 中被替换为了一个更加通用的 ServerConnector。")]),e._v(" "),t("p",[e._v("SelectChannelConnector 是 Jetty 6 中用于处理连接的 Connector 实现，它使用 Java NIO 解决了传统的阻塞式 IO 模型的性能瓶颈问题。但是该实现已经过时，不再被推荐使用。")]),e._v(" "),t("p",[e._v("在 Jetty 9 中，ServerConnector 是一个更加通用的 Connector 实现，它支持多种传输协议和 IO 模型，并提供了更加灵活的配置选项。ServerConnector 通过使用 Jetty 的 I/O 层来与客户端进行通信，可以使用 NIO、NIO2、AIO、BIO 等多种 I/O 模型。")]),e._v(" "),t("p",[e._v("如果您需要在 Jetty 9 中使用类似于 SelectChannelConnector 的功能，可以考虑使用 ServerConnector，并根据您的具体需求进行配置。例如，通过设置 ServerConnector 的 acceptors 和 selectors 参数可以控制 I/O 线程池的大小，从而优化性能。")]),e._v(" "),t("h3",{attrs:{id:"sslsocketconnector-加密类差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sslsocketconnector-加密类差异"}},[e._v("#")]),e._v(" SslSocketConnector -加密类差异")]),e._v(" "),t("p",[e._v("在 Jetty 6 中使用的 SslSocketConnector 在 Jetty 9 中被替换为了一个更加通用的 SslConnectionFactory。")]),e._v(" "),t("p",[e._v("SslSocketConnector 是 Jetty 6 中用于处理 SSL/TLS 连接的 Connector 实现，它在传输层提供了安全的加密和认证机制。但是该实现已经过时，不再被推荐使用。")]),e._v(" "),t("p",[e._v("在 Jetty 9 中，SslConnectionFactory 是一个更加通用的 Ssl Connector 实现，它支持多种传输协议和 I/O 模型，并提供了更加灵活的配置选项。SslConnectionFactory 可以与 ServerConnector 或者 HttpConnectionFactory 等其他 ConnectionFactory 组合使用，从而实现对 HTTP 或者 WebSocket 等协议的加密和认证。")]),e._v(" "),t("p",[e._v("如果您需要在 Jetty 9 中使用类似于 SslSocketConnector 的功能，可以考虑使用 SslConnectionFactory 并根据您的具体需求进行配置。例如，通过设置 SslContextFactory 的参数可以控制加密套件、协议版本、证书链等方面的细节，从而实现更加安全和高效的 SSL/TLS 连接。")]),e._v(" "),t("h3",{attrs:{id:"request-http请求差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#request-http请求差异"}},[e._v("#")]),e._v(" Request-HTTP请求差异")]),e._v(" "),t("p",[e._v("在 Jetty 6 中，用于处理 HTTP 请求的对象是 org.mortbay.jetty.Request。而在 Jetty 9 中，对应的对象是 javax.servlet.http.HttpServletRequest。")]),e._v(" "),t("p",[e._v("Jetty 9 是基于 Servlet 规范的，因此它使用标准的 javax.servlet.http.HttpServletRequest 对象来表示 HTTP 请求。HttpServletRequest 提供了丰富的方法和属性，用于获取请求的各种信息，如参数、头部、Cookie 等。与 Jetty 6 中的 org.mortbay.jetty.Request 对象相比，HttpServletRequest 更加标准化和通用化，可以与其他符合 Servlet 规范的容器和框架进行更好的集成。")]),e._v(" "),t("p",[e._v("如果您需要在 Jetty 9 中处理 HTTP 请求，可以直接使用 HttpServletRequest 对象，无需再关心 Jetty 内部的实现细节。ServletRequest、ServletResponse 和 HttpSession 等对象也都是基于 Servlet 规范的标准对象，可以直接在 Jetty 9 中使用。")]),e._v(" "),t("h3",{attrs:{id:"webappcontext"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webappcontext"}},[e._v("#")]),e._v(" WebAppContext")]),e._v(" "),t("p",[e._v("Jetty 6和9之间有一些重要的差异，在使用"),t("code",[e._v("WebAppContext")]),e._v("时需要特别注意。")]),e._v(" "),t("ol",[t("li",[e._v("包名不同")])]),e._v(" "),t("p",[e._v("在Jetty 6中，"),t("code",[e._v("WebAppContext")]),e._v("的类路径是"),t("code",[e._v("org.mortbay.jetty.webapp.WebAppContext")]),e._v("。而在Jetty 9中，类路径变为了"),t("code",[e._v("org.eclipse.jetty.webapp.WebAppContext")]),e._v("。")]),e._v(" "),t("p",[e._v("进而导致jetty-web.xml中需要修改WebAppContext包目录和dtd文件名")]),e._v(" "),t("ol",[t("li",[e._v("配置方式不同")])]),e._v(" "),t("p",[e._v("在Jetty 6中，您通常会使用web.xml文件来配置Web应用程序上下文。在Jetty 9中，您可以通过编程方式配置Web应用程序上下文")]),e._v(" "),t("h3",{attrs:{id:"web-xml配置差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#web-xml配置差异"}},[e._v("#")]),e._v(" web.xml配置差异")]),e._v(" "),t("p",[e._v("jetty版本差异，造就web.xml中jetty类的包路径需要修改")]),e._v(" "),t("h3",{attrs:{id:"jsp支持-本地验证后-发现工作量主要在这块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jsp支持-本地验证后-发现工作量主要在这块"}},[e._v("#")]),e._v(" jsp支持（本地验证后-发现工作量主要在这块）")]),e._v(" "),t("p",[e._v("jetty9对jsp支持的，配置类写法不同，需要改动；")]),e._v(" "),t("blockquote",[t("p",[e._v("（这块需要研究jetty9的配置方式），目前本地运行时，已经遇到各种报错，怀疑是jar包没引入全导致，还在验证中")])]),e._v(" "),t("h2",{attrs:{id:"_5-其他-无差异"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-其他-无差异"}},[e._v("#")]),e._v(" 5.其他-无差异")]),e._v(" "),t("h3",{attrs:{id:"spring版本差异-改动后需要验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spring版本差异-改动后需要验证"}},[e._v("#")]),e._v(" spring版本差异（改动后需要验证）")]),e._v(" "),t("p",[e._v("Jetty 9支持的最旧的Spring版本是Spring Framework 4.0。")]),e._v(" "),t("p",[e._v("而ALGO使用的spring为5.0.6，故理论上spring不存在兼容问题，但也需验证")]),e._v(" "),t("p",[e._v("Jetty 9支持Servlet规范3.1和4.0，而Spring Framework 4.x系列是与Servlet 3.0兼容的版本，因此可以在Jetty 9中使用。从Spring Framework 4.0开始，Spring团队官方支持Servlet 3.0，这使得Spring 4.0及更高版本成为与Jetty 9兼容的选择。")]),e._v(" "),t("h2",{attrs:{id:"报错解决"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#报错解决"}},[e._v("#")]),e._v(" 报错解决")]),e._v(" "),t("p",[e._v("报错：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("java.lang.NullPointerException\n    at org.apache.jasper.compiler.Validator$ValidateVisitor.<init>(Validator.java:515)\n    at org.apache.jasper.compiler.Validator.validateExDirectives(Validator.java:1853)\n    at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:217)\n    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:356)\n    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:336)\n    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:323)\n    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:585)\n    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:363)\n    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:396)\n    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:340)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:837)\n    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:583)\n    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\n    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)\n    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\n    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n    at org.eclipse.jetty.server.Server.handle(Server.java:524)\n    at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:319)\n    at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:253)\n    at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)\n    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n    at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n    at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n    at java.lang.Thread.run(Thread.java:745)\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br"),t("span",{staticClass:"line-number"},[e._v("24")]),t("br"),t("span",{staticClass:"line-number"},[e._v("25")]),t("br"),t("span",{staticClass:"line-number"},[e._v("26")]),t("br"),t("span",{staticClass:"line-number"},[e._v("27")]),t("br"),t("span",{staticClass:"line-number"},[e._v("28")]),t("br"),t("span",{staticClass:"line-number"},[e._v("29")]),t("br"),t("span",{staticClass:"line-number"},[e._v("30")]),t("br"),t("span",{staticClass:"line-number"},[e._v("31")]),t("br"),t("span",{staticClass:"line-number"},[e._v("32")]),t("br"),t("span",{staticClass:"line-number"},[e._v("33")]),t("br"),t("span",{staticClass:"line-number"},[e._v("34")]),t("br"),t("span",{staticClass:"line-number"},[e._v("35")]),t("br")])]),t("p",[e._v("解决方案：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("https://segmentfault.com/q/1010000006126591\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"官网demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官网demo"}},[e._v("#")]),e._v(" 官网DEMO")]),e._v(" "),t("p",[t("code",[e._v("https://github.com/jetty-project/embedded-jetty-jsp/blob/jetty-9.4.x/src/main/java/org/eclipse/jetty/demo/Main.java")])]),e._v(" "),t("h2",{attrs:{id:"思考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#思考"}},[e._v("#")]),e._v(" 思考")]),e._v(" "),t("ol",[t("li",[e._v("内存，CPU占用不能变动太大")]),e._v(" "),t("li",[e._v("引入新版本jetty9后，是否有安全漏洞等问题")])])])}),[],!1,null,null,null);t.default=s.exports}}]);