(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{393:function(_,v,t){"use strict";t.r(v);var d=t(5),r=Object(d.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("p",[_._v("错误提示的意思，很明显，是因为这条语句被锁住了。所以释放这个锁\n我们可以到information_schema中查询")]),_._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("解释：information_schema这张数据表保存了MySQL服务器所有数据库的信息。\n如数据库名，数据库的表，表栏的数据类型与访问权限等。\n再简单点，这台MySQL服务器上，到底有哪些数据库、各个数据库有哪些表，每张表的字段类型是什\n么，各个数据库要什么权限才能访问，等等信息都保存在information_schema表里面。\n\n我们可以用下面三张表来查原因：\n       innodb_trx 当前运行的所有事务\n       innodb_locks  当前出现的锁\n       innodb_lock_waits  锁等待的对应关系\n")])]),_._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[_._v("1")]),v("br"),v("span",{staticClass:"line-number"},[_._v("2")]),v("br"),v("span",{staticClass:"line-number"},[_._v("3")]),v("br"),v("span",{staticClass:"line-number"},[_._v("4")]),v("br"),v("span",{staticClass:"line-number"},[_._v("5")]),v("br"),v("span",{staticClass:"line-number"},[_._v("6")]),v("br"),v("span",{staticClass:"line-number"},[_._v("7")]),v("br"),v("span",{staticClass:"line-number"},[_._v("8")]),v("br"),v("span",{staticClass:"line-number"},[_._v("9")]),v("br")])]),v("ul",[v("li",[_._v("查看数据库锁id\n"),v("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200426094251892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaW9mY2hhbw==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),_._v(" "),v("li",[_._v("图中红色语句为占用系统资源的语句，我们需要杀掉这个锁，执行 kill 线程id号。上面这条记录的id为319618246\n所以我们执行：kill 319618246即可\n执行之后：\n"),v("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020042609440917.png",alt:"在这里插入图片描述"}}),_._v("\n其他的记录不需要关注，因为其他的记录状态为“RUNNING” 即正在执行的事务，并没有锁")])]),_._v(" "),v("p",[_._v("扩展：表结构")]),_._v(" "),v("p",[v("strong",[_._v("desc information_schema.innodb_locks;")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("Field")]),_._v(" "),v("th",[_._v("Type")]),_._v(" "),v("th",[_._v("Null")]),_._v(" "),v("th",[_._v("Key")]),_._v(" "),v("th",[_._v("Default")]),_._v(" "),v("th",[_._v("Remark")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("lock_id")]),_._v(" "),v("td",[_._v("varchar(81)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("锁ID")])]),_._v(" "),v("tr",[v("td",[_._v("lock_trx_id")]),_._v(" "),v("td",[_._v("varchar(18)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("拥有锁的事务ID")])]),_._v(" "),v("tr",[v("td",[_._v("lock_mode")]),_._v(" "),v("td",[_._v("varchar(32)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("锁模式")])]),_._v(" "),v("tr",[v("td",[_._v("lock_type")]),_._v(" "),v("td",[_._v("varchar(32)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("锁类型")])]),_._v(" "),v("tr",[v("td",[_._v("lock_table")]),_._v(" "),v("td",[_._v("varchar(1024)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("被锁的表")])]),_._v(" "),v("tr",[v("td",[_._v("lock_index")]),_._v(" "),v("td",[_._v("varchar(1024)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("被锁的索引")])]),_._v(" "),v("tr",[v("td",[_._v("lock_space")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("被锁的表空间号")])]),_._v(" "),v("tr",[v("td",[_._v("lock_page")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("被锁的页号")])]),_._v(" "),v("tr",[v("td",[_._v("lock_rec")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("被锁的记录号")])]),_._v(" "),v("tr",[v("td",[_._v("lock_data")]),_._v(" "),v("td",[_._v("varchar(8192)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("被锁的数据")])])])]),_._v(" "),v("p",[v("strong",[_._v("desc information_schema.innodb_lock_waits")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("Field")]),_._v(" "),v("th",[_._v("Type")]),_._v(" "),v("th",[_._v("Null")]),_._v(" "),v("th",[_._v("Key")]),_._v(" "),v("th",[_._v("Default")]),_._v(" "),v("th",[_._v("Remark")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("requesting_trx_id")]),_._v(" "),v("td",[_._v("varchar(18)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("请求锁的事务ID")])]),_._v(" "),v("tr",[v("td",[_._v("requested_lock_id")]),_._v(" "),v("td",[_._v("varchar(81)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("请求锁的锁ID")])]),_._v(" "),v("tr",[v("td",[_._v("blocking_trx_id")]),_._v(" "),v("td",[_._v("varchar(18)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("当前拥有锁的事务ID")])]),_._v(" "),v("tr",[v("td",[_._v("blocking_lock_id")]),_._v(" "),v("td",[_._v("varchar(81)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("当前拥有锁的锁ID")])])])]),_._v(" "),v("p",[v("strong",[_._v("desc information_schema.innodb_trx ;")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("Field")]),_._v(" "),v("th",[_._v("Type")]),_._v(" "),v("th",[_._v("Null")]),_._v(" "),v("th",[_._v("Default")]),_._v(" "),v("th",[_._v("Remark")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("trx_id")]),_._v(" "),v("td",[_._v("varchar(18)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("事务ID")])]),_._v(" "),v("tr",[v("td",[_._v("trx_state")]),_._v(" "),v("td",[_._v("varchar(13)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("事务状态：")])]),_._v(" "),v("tr",[v("td",[_._v("trx_started")]),_._v(" "),v("td",[_._v("datetime")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0000-00-00 00:00:00")]),_._v(" "),v("td",[_._v("事务开始时间；")])]),_._v(" "),v("tr",[v("td",[_._v("trx_requested_lock_id")]),_._v(" "),v("td",[_._v("varchar(81)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[v("strong",[_._v("innodb_locks.lock_id")])])]),_._v(" "),v("tr",[v("td",[_._v("trx_wait_started\tdatetime")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("事务开始等待的时间")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("trx_weight")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("#")])]),_._v(" "),v("tr",[v("td",[_._v("trx_mysql_thread_id\tbigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务线程ID")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("trx_query\tvarchar(1024)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("具体SQL语句")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("trx_operation_state")]),_._v(" "),v("td",[_._v("varchar(64)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("事务当前操作状态")])]),_._v(" "),v("tr",[v("td",[_._v("trx_tables_in_use")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务中有多少个表被使用")])]),_._v(" "),v("tr",[v("td",[_._v("trx_tables_locked")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务拥有多少个锁")])]),_._v(" "),v("tr",[v("td",[_._v("trx_lock_structs")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("#")])]),_._v(" "),v("tr",[v("td",[_._v("trx_lock_memory_bytes")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务锁住的内存大小（B）")])]),_._v(" "),v("tr",[v("td",[_._v("trx_rows_locked")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务锁住的行数")])]),_._v(" "),v("tr",[v("td",[_._v("trx_rows_modified")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务更改的行数")])]),_._v(" "),v("tr",[v("td",[_._v("trx_concurrency_tickets")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("事务并发票数")])]),_._v(" "),v("tr",[v("td",[_._v("trx_isolation_level")]),_._v(" "),v("td",[_._v("varchar(16)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("事务隔离级别")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("trx_unique_checks")]),_._v(" "),v("td",[_._v("int(1)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("是否唯一性检查")])]),_._v(" "),v("tr",[v("td",[_._v("trx_foreign_key_checks")]),_._v(" "),v("td",[_._v("int(1)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("是否外键检查")])]),_._v(" "),v("tr",[v("td",[_._v("trx_last_foreign_key_error")]),_._v(" "),v("td",[_._v("varchar(256)")]),_._v(" "),v("td",[_._v("YES")]),_._v(" "),v("td",[_._v("NULL")]),_._v(" "),v("td",[_._v("最后的外键错误")])]),_._v(" "),v("tr",[v("td",[_._v("trx_adaptive_hash_latched")]),_._v(" "),v("td",[_._v("int(1)")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("#")])]),_._v(" "),v("tr",[v("td",[_._v("trx_adaptive_hash_timeout")]),_._v(" "),v("td",[_._v("bigint(21) unsigned")]),_._v(" "),v("td",[_._v("NO")]),_._v(" "),v("td",[_._v("0")]),_._v(" "),v("td",[_._v("#")])])])])])}),[],!1,null,null,null);v.default=r.exports}}]);